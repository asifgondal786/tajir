{"version":3,"file":"full.esm.js","mappings":"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","sources":["webpack://sixel/./upng.js","webpack://sixel/webpack/bootstrap","webpack://sixel/webpack/runtime/define property getters","webpack://sixel/webpack/runtime/hasOwnProperty shorthand","webpack://sixel/./src/Colors.ts","webpack://sixel/./src/wasm.ts","webpack://sixel/./src/Decoder.ts","webpack://sixel/./src/upng.ts","webpack://sixel/./src/Quantizer.ts","webpack://sixel/./src/SixelEncoder.ts"],"sourcesContent":["\n/**\n * UPNG.js taken from https://github.com/photopea/UPNG.js\n * commit cb463cb7b857fc1fbd47bb8628c536e02aaa24ce\n * license: MIT License, Copyright (c) 2017 Photopea\n */\nmodule.exports = UPNG = {};\n\n\t\n\nUPNG.toRGBA8 = function(out)\n{\n\tvar w = out.width, h = out.height;\n\tif(out.tabs.acTL==null) return [UPNG.toRGBA8.decodeImage(out.data, w, h, out).buffer];\n\t\n\tvar frms = [];\n\tif(out.frames[0].data==null) out.frames[0].data = out.data;\n\t\n\tvar len = w*h*4, img = new Uint8Array(len), empty = new Uint8Array(len), prev=new Uint8Array(len);\n\tfor(var i=0; i<out.frames.length; i++)\n\t{\n\t\tvar frm = out.frames[i];\n\t\tvar fx=frm.rect.x, fy=frm.rect.y, fw = frm.rect.width, fh = frm.rect.height;\n\t\tvar fdata = UPNG.toRGBA8.decodeImage(frm.data, fw,fh, out);\n\t\t\n\t\tif(i!=0) for(var j=0; j<len; j++) prev[j]=img[j];\n\t\t\n\t\tif     (frm.blend==0) UPNG._copyTile(fdata, fw, fh, img, w, h, fx, fy, 0);\n\t\telse if(frm.blend==1) UPNG._copyTile(fdata, fw, fh, img, w, h, fx, fy, 1);\n\t\t\n\t\tfrms.push(img.buffer.slice(0));\n\t\t\n\t\tif     (frm.dispose==0) {}\n\t\telse if(frm.dispose==1) UPNG._copyTile(empty, fw, fh, img, w, h, fx, fy, 0);\n\t\telse if(frm.dispose==2) for(var j=0; j<len; j++) img[j]=prev[j];\n\t}\n\treturn frms;\n}\nUPNG.toRGBA8.decodeImage = function(data, w, h, out)\n{\n\tvar area = w*h, bpp = UPNG.decode._getBPP(out);\n\tvar bpl = Math.ceil(w*bpp/8);\t// bytes per line\n\n\tvar bf = new Uint8Array(area*4), bf32 = new Uint32Array(bf.buffer);\n\tvar ctype = out.ctype, depth = out.depth;\n\tvar rs = UPNG._bin.readUshort;\n\t\n\t//console.log(ctype, depth);\n\tvar time = Date.now();\n\n\tif     (ctype==6) { // RGB + alpha\n\t\tvar qarea = area<<2;\n\t\tif(depth== 8) for(var i=0; i<qarea;i+=4) {  bf[i] = data[i];  bf[i+1] = data[i+1];  bf[i+2] = data[i+2];  bf[i+3] = data[i+3]; }\n\t\tif(depth==16) for(var i=0; i<qarea;i++ ) {  bf[i] = data[i<<1];  }\n\t}\n\telse if(ctype==2) {\t// RGB\n\t\tvar ts=out.tabs[\"tRNS\"];\n\t\tif(ts==null) {\n\t\t\tif(depth== 8) for(var i=0; i<area; i++) {  var ti=i*3;  bf32[i] = (255<<24)|(data[ti+2]<<16)|(data[ti+1]<<8)|data[ti];  }\n\t\t\tif(depth==16) for(var i=0; i<area; i++) {  var ti=i*6;  bf32[i] = (255<<24)|(data[ti+4]<<16)|(data[ti+2]<<8)|data[ti];  }\n\t\t}\n\t\telse {  var tr=ts[0], tg=ts[1], tb=ts[2];\n\t\t\tif(depth== 8) for(var i=0; i<area; i++) {  var qi=i<<2, ti=i*3;  bf32[i] = (255<<24)|(data[ti+2]<<16)|(data[ti+1]<<8)|data[ti];\n\t\t\t\tif(data[ti]   ==tr && data[ti+1]   ==tg && data[ti+2]   ==tb) bf[qi+3] = 0;  }\n\t\t\tif(depth==16) for(var i=0; i<area; i++) {  var qi=i<<2, ti=i*6;  bf32[i] = (255<<24)|(data[ti+4]<<16)|(data[ti+2]<<8)|data[ti];\n\t\t\t\tif(rs(data,ti)==tr && rs(data,ti+2)==tg && rs(data,ti+4)==tb) bf[qi+3] = 0;  }\n\t\t}\n\t}\n\telse if(ctype==3) {\t// palette\n\t\tvar p=out.tabs[\"PLTE\"], ap=out.tabs[\"tRNS\"], tl=ap?ap.length:0;\n\t\t//console.log(p, ap);\n\t\tif(depth==1) for(var y=0; y<h; y++) {  var s0 = y*bpl, t0 = y*w;\n\t\t\tfor(var i=0; i<w; i++) { var qi=(t0+i)<<2, j=((data[s0+(i>>3)]>>(7-((i&7)<<0)))& 1), cj=3*j;  bf[qi]=p[cj];  bf[qi+1]=p[cj+1];  bf[qi+2]=p[cj+2];  bf[qi+3]=(j<tl)?ap[j]:255;  }\n\t\t}\n\t\tif(depth==2) for(var y=0; y<h; y++) {  var s0 = y*bpl, t0 = y*w;\n\t\t\tfor(var i=0; i<w; i++) { var qi=(t0+i)<<2, j=((data[s0+(i>>2)]>>(6-((i&3)<<1)))& 3), cj=3*j;  bf[qi]=p[cj];  bf[qi+1]=p[cj+1];  bf[qi+2]=p[cj+2];  bf[qi+3]=(j<tl)?ap[j]:255;  }\n\t\t}\n\t\tif(depth==4) for(var y=0; y<h; y++) {  var s0 = y*bpl, t0 = y*w;\n\t\t\tfor(var i=0; i<w; i++) { var qi=(t0+i)<<2, j=((data[s0+(i>>1)]>>(4-((i&1)<<2)))&15), cj=3*j;  bf[qi]=p[cj];  bf[qi+1]=p[cj+1];  bf[qi+2]=p[cj+2];  bf[qi+3]=(j<tl)?ap[j]:255;  }\n\t\t}\n\t\tif(depth==8) for(var i=0; i<area; i++ ) {  var qi=i<<2, j=data[i]                      , cj=3*j;  bf[qi]=p[cj];  bf[qi+1]=p[cj+1];  bf[qi+2]=p[cj+2];  bf[qi+3]=(j<tl)?ap[j]:255;  }\n\t}\n\telse if(ctype==4) {\t// gray + alpha\n\t\tif(depth== 8)  for(var i=0; i<area; i++) {  var qi=i<<2, di=i<<1, gr=data[di];  bf[qi]=gr;  bf[qi+1]=gr;  bf[qi+2]=gr;  bf[qi+3]=data[di+1];  }\n\t\tif(depth==16)  for(var i=0; i<area; i++) {  var qi=i<<2, di=i<<2, gr=data[di];  bf[qi]=gr;  bf[qi+1]=gr;  bf[qi+2]=gr;  bf[qi+3]=data[di+2];  }\n\t}\n\telse if(ctype==0) {\t// gray\n\t\tvar tr = out.tabs[\"tRNS\"] ? out.tabs[\"tRNS\"] : -1;\n\t\tfor(var y=0; y<h; y++) {\n\t\t\tvar off = y*bpl, to = y*w;\n\t\t\tif     (depth== 1) for(var x=0; x<w; x++) {  var gr=255*((data[off+(x>>>3)]>>>(7 -((x&7)   )))& 1), al=(gr==tr*255)?0:255;  bf32[to+x]=(al<<24)|(gr<<16)|(gr<<8)|gr;  }\n\t\t\telse if(depth== 2) for(var x=0; x<w; x++) {  var gr= 85*((data[off+(x>>>2)]>>>(6 -((x&3)<<1)))& 3), al=(gr==tr* 85)?0:255;  bf32[to+x]=(al<<24)|(gr<<16)|(gr<<8)|gr;  }\n\t\t\telse if(depth== 4) for(var x=0; x<w; x++) {  var gr= 17*((data[off+(x>>>1)]>>>(4 -((x&1)<<2)))&15), al=(gr==tr* 17)?0:255;  bf32[to+x]=(al<<24)|(gr<<16)|(gr<<8)|gr;  }\n\t\t\telse if(depth== 8) for(var x=0; x<w; x++) {  var gr=data[off+     x], al=(gr                 ==tr)?0:255;  bf32[to+x]=(al<<24)|(gr<<16)|(gr<<8)|gr;  }\n\t\t\telse if(depth==16) for(var x=0; x<w; x++) {  var gr=data[off+(x<<1)], al=(rs(data,off+(x<<i))==tr)?0:255;  bf32[to+x]=(al<<24)|(gr<<16)|(gr<<8)|gr;  }\n\t\t}\n\t}\n\t//console.log(Date.now()-time);\n\treturn bf;\n}\n\n\n\nUPNG.decode = function(buff)\n{\n\tvar data = new Uint8Array(buff), offset = 8, bin = UPNG._bin, rUs = bin.readUshort, rUi = bin.readUint;\n\tvar out = {tabs:{}, frames:[]};\n\tvar dd = new Uint8Array(data.length), doff = 0;\t // put all IDAT data into it\n\tvar fd, foff = 0;\t// frames\n\t\n\tvar mgck = [0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a];\n\tfor(var i=0; i<8; i++) if(data[i]!=mgck[i]) throw \"The input is not a PNG file!\";\n\n\twhile(offset<data.length)\n\t{\n\t\tvar len  = bin.readUint(data, offset);  offset += 4;\n\t\tvar type = bin.readASCII(data, offset, 4);  offset += 4;\n\t\t//console.log(type,len);\n\t\t\n\t\tif     (type==\"IHDR\")  {  UPNG.decode._IHDR(data, offset, out);  }\n\t\telse if(type==\"CgBI\")  {  out.tabs[type] = data.slice(offset,offset+4);  }\n\t\telse if(type==\"IDAT\") {\n\t\t\tfor(var i=0; i<len; i++) dd[doff+i] = data[offset+i];\n\t\t\tdoff += len;\n\t\t}\n\t\telse if(type==\"acTL\")  {\n\t\t\tout.tabs[type] = {  num_frames:rUi(data, offset), num_plays:rUi(data, offset+4)  };\n\t\t\tfd = new Uint8Array(data.length);\n\t\t}\n\t\telse if(type==\"fcTL\")  {\n\t\t\tif(foff!=0) {  var fr = out.frames[out.frames.length-1];\n\t\t\t\tfr.data = UPNG.decode._decompress(out, fd.slice(0,foff), fr.rect.width, fr.rect.height);  foff=0;\n\t\t\t}\n\t\t\tvar rct = {x:rUi(data, offset+12),y:rUi(data, offset+16),width:rUi(data, offset+4),height:rUi(data, offset+8)};\n\t\t\tvar del = rUs(data, offset+22);  del = rUs(data, offset+20) / (del==0?100:del);\n\t\t\tvar frm = {rect:rct, delay:Math.round(del*1000), dispose:data[offset+24], blend:data[offset+25]};\n\t\t\t//console.log(frm);\n\t\t\tout.frames.push(frm);\n\t\t}\n\t\telse if(type==\"fdAT\") {\n\t\t\tfor(var i=0; i<len-4; i++) fd[foff+i] = data[offset+i+4];\n\t\t\tfoff += len-4;\n\t\t}\n\t\telse if(type==\"pHYs\") {\n\t\t\tout.tabs[type] = [bin.readUint(data, offset), bin.readUint(data, offset+4), data[offset+8]];\n\t\t}\n\t\telse if(type==\"cHRM\") {\n\t\t\tout.tabs[type] = [];\n\t\t\tfor(var i=0; i<8; i++) out.tabs[type].push(bin.readUint(data, offset+i*4));\n\t\t}\n\t\telse if(type==\"tEXt\" || type==\"zTXt\") {\n\t\t\tif(out.tabs[type]==null) out.tabs[type] = {};\n\t\t\tvar nz = bin.nextZero(data, offset);\n\t\t\tvar keyw = bin.readASCII(data, offset, nz-offset);\n\t\t\tvar text, tl=offset+len-nz-1;\n\t\t\tif(type==\"tEXt\") text = bin.readASCII(data, nz+1, tl);\n\t\t\telse {\n\t\t\t\tvar bfr = UPNG.decode._inflate(data.slice(nz+2,nz+2+tl));\n\t\t\t\ttext = bin.readUTF8(bfr,0,bfr.length);\n\t\t\t}\n\t\t\tout.tabs[type][keyw] = text;\n\t\t}\n\t\telse if(type==\"iTXt\") {\n\t\t\tif(out.tabs[type]==null) out.tabs[type] = {};\n\t\t\tvar nz = 0, off = offset;\n\t\t\tnz = bin.nextZero(data, off);\n\t\t\tvar keyw = bin.readASCII(data, off, nz-off);  off = nz + 1;\n\t\t\tvar cflag = data[off], cmeth = data[off+1];  off+=2;\n\t\t\tnz = bin.nextZero(data, off);\n\t\t\tvar ltag = bin.readASCII(data, off, nz-off);  off = nz + 1;\n\t\t\tnz = bin.nextZero(data, off);\n\t\t\tvar tkeyw = bin.readUTF8(data, off, nz-off);  off = nz + 1;\n\t\t\tvar text, tl=len-(off-offset);\n\t\t\tif(cflag==0) text  = bin.readUTF8(data, off, tl);\n\t\t\telse {\n\t\t\t\tvar bfr = UPNG.decode._inflate(data.slice(off,off+tl));\n\t\t\t\ttext = bin.readUTF8(bfr,0,bfr.length);\n\t\t\t}\n\t\t\tout.tabs[type][keyw] = text;\n\t\t}\n\t\telse if(type==\"PLTE\") {\n\t\t\tout.tabs[type] = bin.readBytes(data, offset, len);\n\t\t}\n\t\telse if(type==\"hIST\") {\n\t\t\tvar pl = out.tabs[\"PLTE\"].length/3;\n\t\t\tout.tabs[type] = [];  for(var i=0; i<pl; i++) out.tabs[type].push(rUs(data, offset+i*2));\n\t\t}\n\t\telse if(type==\"tRNS\") {\n\t\t\tif     (out.ctype==3) out.tabs[type] = bin.readBytes(data, offset, len);\n\t\t\telse if(out.ctype==0) out.tabs[type] = rUs(data, offset);\n\t\t\telse if(out.ctype==2) out.tabs[type] = [ rUs(data,offset),rUs(data,offset+2),rUs(data,offset+4) ];\n\t\t\t//else console.log(\"tRNS for unsupported color type\",out.ctype, len);\n\t\t}\n\t\telse if(type==\"gAMA\") out.tabs[type] = bin.readUint(data, offset)/100000;\n\t\telse if(type==\"sRGB\") out.tabs[type] = data[offset];\n\t\telse if(type==\"bKGD\")\n\t\t{\n\t\t\tif     (out.ctype==0 || out.ctype==4) out.tabs[type] = [rUs(data, offset)];\n\t\t\telse if(out.ctype==2 || out.ctype==6) out.tabs[type] = [rUs(data, offset), rUs(data, offset+2), rUs(data, offset+4)];\n\t\t\telse if(out.ctype==3) out.tabs[type] = data[offset];\n\t\t}\n\t\telse if(type==\"IEND\") {\n\t\t\tbreak;\n\t\t}\n\t\t//else {  log(\"unknown chunk type\", type, len);  }\n\t\toffset += len;\n\t\tvar crc = bin.readUint(data, offset);  offset += 4;\n\t}\n\tif(foff!=0) {  var fr = out.frames[out.frames.length-1];\n\t\tfr.data = UPNG.decode._decompress(out, fd.slice(0,foff), fr.rect.width, fr.rect.height);  foff=0;\n\t}\t\n\tout.data = UPNG.decode._decompress(out, dd, out.width, out.height);\n\t\n\tdelete out.compress;  delete out.interlace;  delete out.filter;\n\treturn out;\n}\n\nUPNG.decode._decompress = function(out, dd, w, h) {\n\tvar time = Date.now();\n\tvar bpp = UPNG.decode._getBPP(out), bpl = Math.ceil(w*bpp/8), buff = new Uint8Array((bpl+1+out.interlace)*h);\n\tif(out.tabs[\"CgBI\"]) dd = UPNG.inflateRaw(dd,buff);\n\telse                 dd = UPNG.decode._inflate(dd,buff);\n\t//console.log(dd.length, buff.length);\n\t//console.log(Date.now()-time);\n\n\tvar time=Date.now();\n\tif     (out.interlace==0) dd = UPNG.decode._filterZero(dd, out, 0, w, h);\n\telse if(out.interlace==1) dd = UPNG.decode._readInterlace(dd, out);\n\t//console.log(Date.now()-time);\n\treturn dd;\n}\n\nUPNG.decode._inflate = function(data, buff) {  var out=UPNG[\"inflateRaw\"](new Uint8Array(data.buffer, 2,data.length-6),buff);  return out;  }\nUPNG.inflateRaw=function(){var H={};H.H={};H.H.N=function(N,W){var R=Uint8Array,i=0,m=0,J=0,h=0,Q=0,X=0,u=0,w=0,d=0,v,C;\nif(N[0]==3&&N[1]==0)return W?W:new R(0);var V=H.H,n=V.b,A=V.e,l=V.R,M=V.n,I=V.A,e=V.Z,b=V.m,Z=W==null;\nif(Z)W=new R(N.length>>>2<<3);while(i==0){i=n(N,d,1);m=n(N,d+1,2);d+=3;if(m==0){if((d&7)!=0)d+=8-(d&7);\nvar D=(d>>>3)+4,q=N[D-4]|N[D-3]<<8;if(Z)W=H.H.W(W,w+q);W.set(new R(N.buffer,N.byteOffset+D,q),w);d=D+q<<3;\nw+=q;continue}if(Z)W=H.H.W(W,w+(1<<17));if(m==1){v=b.J;C=b.h;X=(1<<9)-1;u=(1<<5)-1}if(m==2){J=A(N,d,5)+257;\nh=A(N,d+5,5)+1;Q=A(N,d+10,4)+4;d+=14;var E=d,j=1;for(var c=0;c<38;c+=2){b.Q[c]=0;b.Q[c+1]=0}for(var c=0;\nc<Q;c++){var K=A(N,d+c*3,3);b.Q[(b.X[c]<<1)+1]=K;if(K>j)j=K}d+=3*Q;M(b.Q,j);I(b.Q,j,b.u);v=b.w;C=b.d;\nd=l(b.u,(1<<j)-1,J+h,N,d,b.v);var r=V.V(b.v,0,J,b.C);X=(1<<r)-1;var S=V.V(b.v,J,h,b.D);u=(1<<S)-1;M(b.C,r);\nI(b.C,r,v);M(b.D,S);I(b.D,S,C)}while(!0){var T=v[e(N,d)&X];d+=T&15;var p=T>>>4;if(p>>>8==0){W[w++]=p}else if(p==256){break}else{var z=w+p-254;\nif(p>264){var _=b.q[p-257];z=w+(_>>>3)+A(N,d,_&7);d+=_&7}var $=C[e(N,d)&u];d+=$&15;var s=$>>>4,Y=b.c[s],a=(Y>>>4)+n(N,d,Y&15);\nd+=Y&15;while(w<z){W[w]=W[w++-a];W[w]=W[w++-a];W[w]=W[w++-a];W[w]=W[w++-a]}w=z}}}return W.length==w?W:W.slice(0,w)};\nH.H.W=function(N,W){var R=N.length;if(W<=R)return N;var V=new Uint8Array(R<<1);V.set(N,0);return V};\nH.H.R=function(N,W,R,V,n,A){var l=H.H.e,M=H.H.Z,I=0;while(I<R){var e=N[M(V,n)&W];n+=e&15;var b=e>>>4;\nif(b<=15){A[I]=b;I++}else{var Z=0,m=0;if(b==16){m=3+l(V,n,2);n+=2;Z=A[I-1]}else if(b==17){m=3+l(V,n,3);\nn+=3}else if(b==18){m=11+l(V,n,7);n+=7}var J=I+m;while(I<J){A[I]=Z;I++}}}return n};H.H.V=function(N,W,R,V){var n=0,A=0,l=V.length>>>1;\nwhile(A<R){var M=N[A+W];V[A<<1]=0;V[(A<<1)+1]=M;if(M>n)n=M;A++}while(A<l){V[A<<1]=0;V[(A<<1)+1]=0;A++}return n};\nH.H.n=function(N,W){var R=H.H.m,V=N.length,n,A,l,M,I,e=R.j;for(var M=0;M<=W;M++)e[M]=0;for(M=1;M<V;M+=2)e[N[M]]++;\nvar b=R.K;n=0;e[0]=0;for(A=1;A<=W;A++){n=n+e[A-1]<<1;b[A]=n}for(l=0;l<V;l+=2){I=N[l+1];if(I!=0){N[l]=b[I];\nb[I]++}}};H.H.A=function(N,W,R){var V=N.length,n=H.H.m,A=n.r;for(var l=0;l<V;l+=2)if(N[l+1]!=0){var M=l>>1,I=N[l+1],e=M<<4|I,b=W-I,Z=N[l]<<b,m=Z+(1<<b);\nwhile(Z!=m){var J=A[Z]>>>15-W;R[J]=e;Z++}}};H.H.l=function(N,W){var R=H.H.m.r,V=15-W;for(var n=0;n<N.length;\nn+=2){var A=N[n]<<W-N[n+1];N[n]=R[A]>>>V}};H.H.M=function(N,W,R){R=R<<(W&7);var V=W>>>3;N[V]|=R;N[V+1]|=R>>>8};\nH.H.I=function(N,W,R){R=R<<(W&7);var V=W>>>3;N[V]|=R;N[V+1]|=R>>>8;N[V+2]|=R>>>16};H.H.e=function(N,W,R){return(N[W>>>3]|N[(W>>>3)+1]<<8)>>>(W&7)&(1<<R)-1};\nH.H.b=function(N,W,R){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16)>>>(W&7)&(1<<R)-1};H.H.Z=function(N,W){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16)>>>(W&7)};\nH.H.i=function(N,W){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16|N[(W>>>3)+3]<<24)>>>(W&7)};H.H.m=function(){var N=Uint16Array,W=Uint32Array;\nreturn{K:new N(16),j:new N(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new N(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new W(32),J:new N(512),_:[],h:new N(32),$:[],w:new N(32768),C:[],v:[],d:new N(32768),D:[],u:new N(512),Q:[],r:new N(1<<15),s:new W(286),Y:new W(30),a:new W(19),t:new W(15e3),k:new N(1<<16),g:new N(1<<15)}}();\n(function(){var N=H.H.m,W=1<<15;for(var R=0;R<W;R++){var V=R;V=(V&2863311530)>>>1|(V&1431655765)<<1;\nV=(V&3435973836)>>>2|(V&858993459)<<2;V=(V&4042322160)>>>4|(V&252645135)<<4;V=(V&4278255360)>>>8|(V&16711935)<<8;\nN.r[R]=(V>>>16|V<<16)>>>17}function n(A,l,M){while(l--!=0)A.push(0,M)}for(var R=0;R<32;R++){N.q[R]=N.S[R]<<3|N.T[R];\nN.c[R]=N.p[R]<<4|N.z[R]}n(N._,144,8);n(N._,255-143,9);n(N._,279-255,7);n(N._,287-279,8);H.H.n(N._,9);\nH.H.A(N._,9,N.J);H.H.l(N._,9);n(N.$,32,5);H.H.n(N.$,5);H.H.A(N.$,5,N.h);H.H.l(N.$,5);n(N.Q,19,0);n(N.C,286,0);\nn(N.D,30,0);n(N.v,320,0)}());return H.H.N}()\n\n\nUPNG.decode._readInterlace = function(data, out)\n{\n\tvar w = out.width, h = out.height;\n\tvar bpp = UPNG.decode._getBPP(out), cbpp = bpp>>3, bpl = Math.ceil(w*bpp/8);\n\tvar img = new Uint8Array( h * bpl );\n\tvar di = 0;\n\n\tvar starting_row  = [ 0, 0, 4, 0, 2, 0, 1 ];\n\tvar starting_col  = [ 0, 4, 0, 2, 0, 1, 0 ];\n\tvar row_increment = [ 8, 8, 8, 4, 4, 2, 2 ];\n\tvar col_increment = [ 8, 8, 4, 4, 2, 2, 1 ];\n\n\tvar pass=0;\n\twhile(pass<7)\n\t{\n\t\tvar ri = row_increment[pass], ci = col_increment[pass];\n\t\tvar sw = 0, sh = 0;\n\t\tvar cr = starting_row[pass];  while(cr<h) {  cr+=ri;  sh++;  }\n\t\tvar cc = starting_col[pass];  while(cc<w) {  cc+=ci;  sw++;  }\n\t\tvar bpll = Math.ceil(sw*bpp/8);\n\t\tUPNG.decode._filterZero(data, out, di, sw, sh);\n\n\t\tvar y=0, row = starting_row[pass];\n\t\twhile(row<h)\n\t\t{\n\t\t\tvar col = starting_col[pass];\n\t\t\tvar cdi = (di+y*bpll)<<3;\n\n\t\t\twhile(col<w)\n\t\t\t{\n\t\t\t\tif(bpp==1) {\n\t\t\t\t\tvar val = data[cdi>>3];  val = (val>>(7-(cdi&7)))&1;\n\t\t\t\t\timg[row*bpl + (col>>3)] |= (val << (7-((col&7)<<0)));\n\t\t\t\t}\n\t\t\t\tif(bpp==2) {\n\t\t\t\t\tvar val = data[cdi>>3];  val = (val>>(6-(cdi&7)))&3;\n\t\t\t\t\timg[row*bpl + (col>>2)] |= (val << (6-((col&3)<<1)));\n\t\t\t\t}\n\t\t\t\tif(bpp==4) {\n\t\t\t\t\tvar val = data[cdi>>3];  val = (val>>(4-(cdi&7)))&15;\n\t\t\t\t\timg[row*bpl + (col>>1)] |= (val << (4-((col&1)<<2)));\n\t\t\t\t}\n\t\t\t\tif(bpp>=8) {\n\t\t\t\t\tvar ii = row*bpl+col*cbpp;\n\t\t\t\t\tfor(var j=0; j<cbpp; j++) img[ii+j] = data[(cdi>>3)+j];\n\t\t\t\t}\n\t\t\t\tcdi+=bpp;  col+=ci;\n\t\t\t}\n\t\t\ty++;  row += ri;\n\t\t}\n\t\tif(sw*sh!=0) di += sh * (1 + bpll);\n\t\tpass = pass + 1;\n\t}\n\treturn img;\n}\n\nUPNG.decode._getBPP = function(out) {\n\tvar noc = [1,null,3,1,2,null,4][out.ctype];\n\treturn noc * out.depth;\n}\n\nUPNG.decode._filterZero = function(data, out, off, w, h)\n{\n\tvar bpp = UPNG.decode._getBPP(out), bpl = Math.ceil(w*bpp/8), paeth = UPNG.decode._paeth;\n\tbpp = Math.ceil(bpp/8);\n\t\n\tvar i=0, di=1, type=data[off], x=0;\n\t\n\tif(type>1) data[off]=[0,0,1][type-2];  \n\tif(type==3) for(x=bpp; x<bpl; x++) data[x+1] = (data[x+1] + (data[x+1-bpp]>>>1) )&255;\n\n\tfor(var y=0; y<h; y++)  {\n\t\ti = off+y*bpl; di = i+y+1;\n\t\ttype = data[di-1]; x=0;\n\n\t\tif     (type==0)   for(; x<bpl; x++) data[i+x] = data[di+x];\n\t\telse if(type==1) { for(; x<bpp; x++) data[i+x] = data[di+x];\n\t\t\t\t\t\t   for(; x<bpl; x++) data[i+x] = (data[di+x] + data[i+x-bpp]);  }\n\t\telse if(type==2) { for(; x<bpl; x++) data[i+x] = (data[di+x] + data[i+x-bpl]);  }\n\t\telse if(type==3) { for(; x<bpp; x++) data[i+x] = (data[di+x] + ( data[i+x-bpl]>>>1));\n\t\t\t               for(; x<bpl; x++) data[i+x] = (data[di+x] + ((data[i+x-bpl]+data[i+x-bpp])>>>1) );  }\n\t\telse             { for(; x<bpp; x++) data[i+x] = (data[di+x] + paeth(0, data[i+x-bpl], 0));\n\t\t\t\t\t\t   for(; x<bpl; x++) data[i+x] = (data[di+x] + paeth(data[i+x-bpp], data[i+x-bpl], data[i+x-bpp-bpl]) );  }\n\t}\n\treturn data;\n}\n\nUPNG.decode._paeth = function(a,b,c)\n{\n\tvar p = a+b-c, pa = (p-a), pb = (p-b), pc = (p-c);\n\tif (pa*pa <= pb*pb && pa*pa <= pc*pc)  return a;\n\telse if (pb*pb <= pc*pc)  return b;\n\treturn c;\n}\n\nUPNG.decode._IHDR = function(data, offset, out)\n{\n\tvar bin = UPNG._bin;\n\tout.width  = bin.readUint(data, offset);  offset += 4;\n\tout.height = bin.readUint(data, offset);  offset += 4;\n\tout.depth     = data[offset];  offset++;\n\tout.ctype     = data[offset];  offset++;\n\tout.compress  = data[offset];  offset++;\n\tout.filter    = data[offset];  offset++;\n\tout.interlace = data[offset];  offset++;\n}\n\nUPNG._bin = {\n\tnextZero   : function(data,p)  {  while(data[p]!=0) p++;  return p;  },\n\treadUshort : function(buff,p)  {  return (buff[p]<< 8) | buff[p+1];  },\n\twriteUshort: function(buff,p,n){  buff[p] = (n>>8)&255;  buff[p+1] = n&255;  },\n\treadUint   : function(buff,p)  {  return (buff[p]*(256*256*256)) + ((buff[p+1]<<16) | (buff[p+2]<< 8) | buff[p+3]);  },\n\twriteUint  : function(buff,p,n){  buff[p]=(n>>24)&255;  buff[p+1]=(n>>16)&255;  buff[p+2]=(n>>8)&255;  buff[p+3]=n&255;  },\n\treadASCII  : function(buff,p,l){  var s = \"\";  for(var i=0; i<l; i++) s += String.fromCharCode(buff[p+i]);  return s;    },\n\twriteASCII : function(data,p,s){  for(var i=0; i<s.length; i++) data[p+i] = s.charCodeAt(i);  },\n\treadBytes  : function(buff,p,l){  var arr = [];   for(var i=0; i<l; i++) arr.push(buff[p+i]);   return arr;  },\n\tpad : function(n) { return n.length < 2 ? \"0\" + n : n; },\n\treadUTF8 : function(buff, p, l) {\n\t\tvar s = \"\", ns;\n\t\tfor(var i=0; i<l; i++) s += \"%\" + UPNG._bin.pad(buff[p+i].toString(16));\n\t\ttry {  ns = decodeURIComponent(s); }\n\t\tcatch(e) {  return UPNG._bin.readASCII(buff, p, l);  }\n\t\treturn  ns;\n\t}\n}\nUPNG._copyTile = function(sb, sw, sh, tb, tw, th, xoff, yoff, mode)\n{\n\tvar w = Math.min(sw,tw), h = Math.min(sh,th);\n\tvar si=0, ti=0;\n\tfor(var y=0; y<h; y++)\n\t\tfor(var x=0; x<w; x++)\n\t\t{\n\t\t\tif(xoff>=0 && yoff>=0) {  si = (y*sw+x)<<2;  ti = (( yoff+y)*tw+xoff+x)<<2;  }\n\t\t\telse                   {  si = ((-yoff+y)*sw-xoff+x)<<2;  ti = (y*tw+x)<<2;  }\n\t\t\t\n\t\t\tif     (mode==0) {  tb[ti] = sb[si];  tb[ti+1] = sb[si+1];  tb[ti+2] = sb[si+2];  tb[ti+3] = sb[si+3];  }\n\t\t\telse if(mode==1) {\n\t\t\t\tvar fa = sb[si+3]*(1/255), fr=sb[si]*fa, fg=sb[si+1]*fa, fb=sb[si+2]*fa; \n\t\t\t\tvar ba = tb[ti+3]*(1/255), br=tb[ti]*ba, bg=tb[ti+1]*ba, bb=tb[ti+2]*ba; \n\t\t\t\t\n\t\t\t\tvar ifa=1-fa, oa = fa+ba*ifa, ioa = (oa==0?0:1/oa);\n\t\t\t\ttb[ti+3] = 255*oa;  \n\t\t\t\ttb[ti+0] = (fr+br*ifa)*ioa;  \n\t\t\t\ttb[ti+1] = (fg+bg*ifa)*ioa;   \n\t\t\t\ttb[ti+2] = (fb+bb*ifa)*ioa;  \n\t\t\t}\n\t\t\telse if(mode==2){\t// copy only differences, otherwise zero\n\t\t\t\tvar fa = sb[si+3], fr=sb[si], fg=sb[si+1], fb=sb[si+2]; \n\t\t\t\tvar ba = tb[ti+3], br=tb[ti], bg=tb[ti+1], bb=tb[ti+2]; \n\t\t\t\tif(fa==ba && fr==br && fg==bg && fb==bb) {  tb[ti]=0;  tb[ti+1]=0;  tb[ti+2]=0;  tb[ti+3]=0;  }\n\t\t\t\telse {  tb[ti]=fr;  tb[ti+1]=fg;  tb[ti+2]=fb;  tb[ti+3]=fa;  }\n\t\t\t}\n\t\t\telse if(mode==3){\t// check if can be blended\n\t\t\t\tvar fa = sb[si+3], fr=sb[si], fg=sb[si+1], fb=sb[si+2]; \n\t\t\t\tvar ba = tb[ti+3], br=tb[ti], bg=tb[ti+1], bb=tb[ti+2]; \n\t\t\t\tif(fa==ba && fr==br && fg==bg && fb==bb) continue;\n\t\t\t\t//if(fa!=255 && ba!=0) return false;\n\t\t\t\tif(fa<220 && ba>20) return false;\n\t\t\t}\n\t\t}\n\treturn true;\n}\n\n\n\n\nUPNG.encode = function(bufs, w, h, ps, dels, tabs, forbidPlte)\n{\n\tif(ps==null) ps=0;\n\tif(forbidPlte==null) forbidPlte = false;\n\n\tvar nimg = UPNG.encode.compress(bufs, w, h, ps, [false, false, false, 0, forbidPlte]);\n\tUPNG.encode.compressPNG(nimg, -1);\n\t\n\treturn UPNG.encode._main(nimg, w, h, dels, tabs);\n}\n\nUPNG.encodeLL = function(bufs, w, h, cc, ac, depth, dels, tabs) {\n\tvar nimg = {  ctype: 0 + (cc==1 ? 0 : 2) + (ac==0 ? 0 : 4),      depth: depth,  frames: []  };\n\t\n\tvar time = Date.now();\n\tvar bipp = (cc+ac)*depth, bipl = bipp * w;\n\tfor(var i=0; i<bufs.length; i++)\n\t\tnimg.frames.push({  rect:{x:0,y:0,width:w,height:h},  img:new Uint8Array(bufs[i]), blend:0, dispose:1, bpp:Math.ceil(bipp/8), bpl:Math.ceil(bipl/8)  });\n\t\n\tUPNG.encode.compressPNG(nimg, 0, true);\n\t\n\tvar out = UPNG.encode._main(nimg, w, h, dels, tabs);\n\treturn out;\n}\n\nUPNG.encode._main = function(nimg, w, h, dels, tabs) {\n\tif(tabs==null) tabs={};\n\tvar crc = UPNG.crc.crc, wUi = UPNG._bin.writeUint, wUs = UPNG._bin.writeUshort, wAs = UPNG._bin.writeASCII;\n\tvar offset = 8, anim = nimg.frames.length>1, pltAlpha = false;\n\t\n\tvar leng = 8 + (16+5+4) /*+ (9+4)*/ + (anim ? 20 : 0);\n\tif(tabs[\"sRGB\"]!=null) leng += 8+1+4;\n\tif(tabs[\"pHYs\"]!=null) leng += 8+9+4;\n\tif(nimg.ctype==3) {\n\t\tvar dl = nimg.plte.length;\n\t\tfor(var i=0; i<dl; i++) if((nimg.plte[i]>>>24)!=255) pltAlpha = true;\n\t\tleng += (8 + dl*3 + 4) + (pltAlpha ? (8 + dl*1 + 4) : 0);\n\t}\n\tfor(var j=0; j<nimg.frames.length; j++)\n\t{\n\t\tvar fr = nimg.frames[j];\n\t\tif(anim) leng += 38;\n\t\tleng += fr.cimg.length + 12;\n\t\tif(j!=0) leng+=4;\n\t}\n\tleng += 12; \n\t\n\tvar data = new Uint8Array(leng);\n\tvar wr=[0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a];\n\tfor(var i=0; i<8; i++) data[i]=wr[i];\n\t\n\twUi(data,offset, 13);     offset+=4;\n\twAs(data,offset,\"IHDR\");  offset+=4;\n\twUi(data,offset,w);  offset+=4;\n\twUi(data,offset,h);  offset+=4;\n\tdata[offset] = nimg.depth;  offset++;  // depth\n\tdata[offset] = nimg.ctype;  offset++;  // ctype\n\tdata[offset] = 0;  offset++;  // compress\n\tdata[offset] = 0;  offset++;  // filter\n\tdata[offset] = 0;  offset++;  // interlace\n\twUi(data,offset,crc(data,offset-17,17));  offset+=4; // crc\n\n\t// 13 bytes to say, that it is sRGB\n\tif(tabs[\"sRGB\"]!=null) {\n\t\twUi(data,offset, 1);      offset+=4;\n\t\twAs(data,offset,\"sRGB\");  offset+=4;\n\t\tdata[offset] = tabs[\"sRGB\"];  offset++;\n\t\twUi(data,offset,crc(data,offset-5,5));  offset+=4; // crc\n\t}\n\tif(tabs[\"pHYs\"]!=null) {\n\t\twUi(data,offset, 9);      offset+=4;\n\t\twAs(data,offset,\"pHYs\");  offset+=4;\n\t\twUi(data,offset, tabs[\"pHYs\"][0]);      offset+=4;\n\t\twUi(data,offset, tabs[\"pHYs\"][1]);      offset+=4;\n\t\tdata[offset]=tabs[\"pHYs\"][2];\t\t\toffset++;\n\t\twUi(data,offset,crc(data,offset-13,13));  offset+=4; // crc\n\t}\n\n\tif(anim) {\n\t\twUi(data,offset, 8);      offset+=4;\n\t\twAs(data,offset,\"acTL\");  offset+=4;\n\t\twUi(data,offset, nimg.frames.length);     offset+=4;\n\t\twUi(data,offset, tabs[\"loop\"]!=null?tabs[\"loop\"]:0);      offset+=4;\n\t\twUi(data,offset,crc(data,offset-12,12));  offset+=4; // crc\n\t}\n\n\tif(nimg.ctype==3) {\n\t\tvar dl = nimg.plte.length;\n\t\twUi(data,offset, dl*3);  offset+=4;\n\t\twAs(data,offset,\"PLTE\");  offset+=4;\n\t\tfor(var i=0; i<dl; i++){\n\t\t\tvar ti=i*3, c=nimg.plte[i], r=(c)&255, g=(c>>>8)&255, b=(c>>>16)&255;\n\t\t\tdata[offset+ti+0]=r;  data[offset+ti+1]=g;  data[offset+ti+2]=b;\n\t\t}\n\t\toffset+=dl*3;\n\t\twUi(data,offset,crc(data,offset-dl*3-4,dl*3+4));  offset+=4; // crc\n\n\t\tif(pltAlpha) {\n\t\t\twUi(data,offset, dl);  offset+=4;\n\t\t\twAs(data,offset,\"tRNS\");  offset+=4;\n\t\t\tfor(var i=0; i<dl; i++)  data[offset+i]=(nimg.plte[i]>>>24)&255;\n\t\t\toffset+=dl;\n\t\t\twUi(data,offset,crc(data,offset-dl-4,dl+4));  offset+=4; // crc\n\t\t}\n\t}\n\t\n\tvar fi = 0;\n\tfor(var j=0; j<nimg.frames.length; j++)\n\t{\n\t\tvar fr = nimg.frames[j];\n\t\tif(anim) {\n\t\t\twUi(data, offset, 26);     offset+=4;\n\t\t\twAs(data, offset,\"fcTL\");  offset+=4;\n\t\t\twUi(data, offset, fi++);   offset+=4;\n\t\t\twUi(data, offset, fr.rect.width );   offset+=4;\n\t\t\twUi(data, offset, fr.rect.height);   offset+=4;\n\t\t\twUi(data, offset, fr.rect.x);   offset+=4;\n\t\t\twUi(data, offset, fr.rect.y);   offset+=4;\n\t\t\twUs(data, offset, dels[j]);   offset+=2;\n\t\t\twUs(data, offset,  1000);   offset+=2;\n\t\t\tdata[offset] = fr.dispose;  offset++;\t// dispose\n\t\t\tdata[offset] = fr.blend  ;  offset++;\t// blend\n\t\t\twUi(data,offset,crc(data,offset-30,30));  offset+=4; // crc\n\t\t}\n\t\t\t\t\n\t\tvar imgd = fr.cimg, dl = imgd.length;\n\t\twUi(data,offset, dl+(j==0?0:4));     offset+=4;\n\t\tvar ioff = offset;\n\t\twAs(data,offset,(j==0)?\"IDAT\":\"fdAT\");  offset+=4;\n\t\tif(j!=0) {  wUi(data, offset, fi++);  offset+=4;  }\n\t\tdata.set(imgd,offset);\n\t\toffset += dl;\n\t\twUi(data,offset,crc(data,ioff,offset-ioff));  offset+=4; // crc\n\t}\n\n\twUi(data,offset, 0);     offset+=4;\n\twAs(data,offset,\"IEND\");  offset+=4;\n\twUi(data,offset,crc(data,offset-4,4));  offset+=4; // crc\n\n\treturn data.buffer;\n}\n\nUPNG.encode.compressPNG = function(out, filter, levelZero) {\n\tfor(var i=0; i<out.frames.length; i++) {\n\t\tvar frm = out.frames[i], nw=frm.rect.width, nh=frm.rect.height;\n\t\tvar fdata = new Uint8Array(nh*frm.bpl+nh);\n\t\tfrm.cimg = UPNG.encode._filterZero(frm.img,nh,frm.bpp,frm.bpl,fdata, filter, levelZero);\n\t}\n}\n\n\n\nUPNG.encode.compress = function(bufs, w, h, ps, prms) // prms:  onlyBlend, minBits, forbidPlte\n{\n\t//var time = Date.now();\n\tvar onlyBlend = prms[0], evenCrd = prms[1], forbidPrev = prms[2], minBits = prms[3], forbidPlte = prms[4];\n\t\n\tvar ctype = 6, depth = 8, alphaAnd=255\n\t\n\tfor(var j=0; j<bufs.length; j++)  {  // when not quantized, other frames can contain colors, that are not in an initial frame\n\t\tvar img = new Uint8Array(bufs[j]), ilen = img.length;\n\t\tfor(var i=0; i<ilen; i+=4) alphaAnd &= img[i+3];\n\t}\n\tvar gotAlpha = (alphaAnd!=255);\n\t\n\t//console.log(\"alpha check\", Date.now()-time);  time = Date.now();\n\t\n\t//var brute = gotAlpha && forGIF;\t\t// brute : frames can only be copied, not \"blended\"\n\tvar frms = UPNG.encode.framize(bufs, w, h, onlyBlend, evenCrd, forbidPrev);\n\t//console.log(\"framize\", Date.now()-time);  time = Date.now();\n\t\n\tvar cmap={}, plte=[], inds=[]; \n\t\n\tif(ps!=0) {\n\t\tvar nbufs = [];  for(var i=0; i<frms.length; i++) nbufs.push(frms[i].img.buffer);\n\t\t\n\t\tvar abuf = UPNG.encode.concatRGBA(nbufs), qres = UPNG.quantize(abuf, ps);  console.log(qres);\n\t\tvar cof = 0, bb = new Uint8Array(qres.abuf);\n\t\tfor(var i=0; i<frms.length; i++) {  var ti=frms[i].img, bln=ti.length;  inds.push(new Uint8Array(qres.inds.buffer, cof>>2, bln>>2));\n\t\t\tfor(var j=0; j<bln; j+=4) {  ti[j]=bb[cof+j];  ti[j+1]=bb[cof+j+1];  ti[j+2]=bb[cof+j+2];  ti[j+3]=bb[cof+j+3];  }    cof+=bln;  }\n\t\t\n\t\tfor(var i=0; i<qres.plte.length; i++) plte.push(qres.plte[i].est.rgba);\n\t\t//console.log(\"quantize\", Date.now()-time);  time = Date.now();\n\t}\n\telse {\n\t\t// what if ps==0, but there are <=256 colors?  we still need to detect, if the palette could be used\n\t\tfor(var j=0; j<frms.length; j++)  {  // when not quantized, other frames can contain colors, that are not in an initial frame\n\t\t\tvar frm = frms[j], img32 = new Uint32Array(frm.img.buffer), nw=frm.rect.width, ilen = img32.length;\n\t\t\tvar ind = new Uint8Array(ilen);  inds.push(ind);\n\t\t\tfor(var i=0; i<ilen; i++) {\n\t\t\t\tvar c = img32[i];\n\t\t\t\tif     (i!=0 && c==img32[i- 1]) ind[i]=ind[i-1];\n\t\t\t\telse if(i>nw && c==img32[i-nw]) ind[i]=ind[i-nw];\n\t\t\t\telse {\n\t\t\t\t\tvar cmc = cmap[c];\n\t\t\t\t\tif(cmc==null) {  cmap[c]=cmc=plte.length;  plte.push(c);  if(plte.length>=300) break;  }\n\t\t\t\t\tind[i]=cmc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//console.log(\"make palette\", Date.now()-time);  time = Date.now();\n\t}\n\t\n\tvar cc=plte.length; //console.log(\"colors:\",cc);\n\tif(cc<=256 && forbidPlte==false) {\n\t\tif(cc<= 2) depth=1;  else if(cc<= 4) depth=2;  else if(cc<=16) depth=4;  else depth=8;\n\t\tdepth =  Math.max(depth, minBits);\n\t}\n\t\n\tfor(var j=0; j<frms.length; j++)\n\t{\n\t\tvar frm = frms[j], nx=frm.rect.x, ny=frm.rect.y, nw=frm.rect.width, nh=frm.rect.height;\n\t\tvar cimg = frm.img, cimg32 = new Uint32Array(cimg.buffer);\n\t\tvar bpl = 4*nw, bpp=4;\n\t\tif(cc<=256 && forbidPlte==false) {\n\t\t\tbpl = Math.ceil(depth*nw/8);\n\t\t\tvar nimg = new Uint8Array(bpl*nh);\n\t\t\tvar inj = inds[j];\n\t\t\tfor(var y=0; y<nh; y++) {  var i=y*bpl, ii=y*nw;\n\t\t\t\tif     (depth==8) for(var x=0; x<nw; x++) nimg[i+(x)   ]   =  (inj[ii+x]             );\n\t\t\t\telse if(depth==4) for(var x=0; x<nw; x++) nimg[i+(x>>1)]  |=  (inj[ii+x]<<(4-(x&1)*4));\n\t\t\t\telse if(depth==2) for(var x=0; x<nw; x++) nimg[i+(x>>2)]  |=  (inj[ii+x]<<(6-(x&3)*2));\n\t\t\t\telse if(depth==1) for(var x=0; x<nw; x++) nimg[i+(x>>3)]  |=  (inj[ii+x]<<(7-(x&7)*1));\n\t\t\t}\n\t\t\tcimg=nimg;  ctype=3;  bpp=1;\n\t\t}\n\t\telse if(gotAlpha==false && frms.length==1) {\t// some next \"reduced\" frames may contain alpha for blending\n\t\t\tvar nimg = new Uint8Array(nw*nh*3), area=nw*nh;\n\t\t\tfor(var i=0; i<area; i++) { var ti=i*3, qi=i*4;  nimg[ti]=cimg[qi];  nimg[ti+1]=cimg[qi+1];  nimg[ti+2]=cimg[qi+2];  }\n\t\t\tcimg=nimg;  ctype=2;  bpp=3;  bpl=3*nw;\n\t\t}\n\t\tfrm.img=cimg;  frm.bpl=bpl;  frm.bpp=bpp;\n\t}\n\t//console.log(\"colors => palette indices\", Date.now()-time);  time = Date.now();\n\t\n\treturn {ctype:ctype, depth:depth, plte:plte, frames:frms  };\n}\nUPNG.encode.framize = function(bufs,w,h,alwaysBlend,evenCrd,forbidPrev) {\n\t/*  DISPOSE\n\t    - 0 : no change\n\t\t- 1 : clear to transparent\n\t\t- 2 : retstore to content before rendering (previous frame disposed)\n\t\tBLEND\n\t\t- 0 : replace\n\t\t- 1 : blend\n\t*/\n\tvar frms = [];\n\tfor(var j=0; j<bufs.length; j++) {\n\t\tvar cimg = new Uint8Array(bufs[j]), cimg32 = new Uint32Array(cimg.buffer);\n\t\tvar nimg;\n\t\t\n\t\tvar nx=0, ny=0, nw=w, nh=h, blend=alwaysBlend?1:0;\n\t\tif(j!=0) {\n\t\t\tvar tlim = (forbidPrev || alwaysBlend || j==1 || frms[j-2].dispose!=0)?1:2, tstp = 0, tarea = 1e9;\n\t\t\tfor(var it=0; it<tlim; it++)\n\t\t\t{\n\t\t\t\tvar pimg = new Uint8Array(bufs[j-1-it]), p32 = new Uint32Array(bufs[j-1-it]);\n\t\t\t\tvar mix=w,miy=h,max=-1,may=-1;\n\t\t\t\tfor(var y=0; y<h; y++) for(var x=0; x<w; x++) {\n\t\t\t\t\tvar i = y*w+x;\n\t\t\t\t\tif(cimg32[i]!=p32[i]) {\n\t\t\t\t\t\tif(x<mix) mix=x;  if(x>max) max=x;\n\t\t\t\t\t\tif(y<miy) miy=y;  if(y>may) may=y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(max==-1) mix=miy=max=may=0;\n\t\t\t\tif(evenCrd) {  if((mix&1)==1)mix--;  if((miy&1)==1)miy--;  }\n\t\t\t\tvar sarea = (max-mix+1)*(may-miy+1);\n\t\t\t\tif(sarea<tarea) {\n\t\t\t\t\ttarea = sarea;  tstp = it;\n\t\t\t\t\tnx = mix; ny = miy; nw = max-mix+1; nh = may-miy+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// alwaysBlend: pokud zjistm, e blendit nelze, nastavm pedchozmu snmku dispose=1. Zajistm, aby obsahoval mj obdlnk.\n\t\t\tvar pimg = new Uint8Array(bufs[j-1-tstp]);\n\t\t\tif(tstp==1) frms[j-1].dispose = 2;\n\t\t\t\n\t\t\tnimg = new Uint8Array(nw*nh*4);\n\t\t\tUPNG._copyTile(pimg,w,h, nimg,nw,nh, -nx,-ny, 0);\n\t\t\t\n\t\t\tblend =  UPNG._copyTile(cimg,w,h, nimg,nw,nh, -nx,-ny, 3) ? 1 : 0;\n\t\t\tif(blend==1) UPNG.encode._prepareDiff(cimg,w,h,nimg,{x:nx,y:ny,width:nw,height:nh});\n\t\t\telse         UPNG._copyTile(cimg,w,h, nimg,nw,nh, -nx,-ny, 0);\n\t\t\t//UPNG._copyTile(cimg,w,h, nimg,nw,nh, -nx,-ny, blend==1?2:0);\n\t\t}\n\t\telse nimg = cimg.slice(0);\t// img may be rewritten further ... don't rewrite input\n\t\t\n\t\tfrms.push({rect:{x:nx,y:ny,width:nw,height:nh}, img:nimg, blend:blend, dispose:0});\n\t}\n\t\n\t\n\tif(alwaysBlend) for(var j=0; j<frms.length; j++) {\n\t\tvar frm = frms[j];  if(frm.blend==1) continue;\n\t\tvar r0 = frm.rect, r1 = frms[j-1].rect\n\t\tvar miX = Math.min(r0.x, r1.x), miY = Math.min(r0.y, r1.y);\n\t\tvar maX = Math.max(r0.x+r0.width, r1.x+r1.width), maY = Math.max(r0.y+r0.height, r1.y+r1.height);\n\t\tvar r = {x:miX, y:miY, width:maX-miX, height:maY-miY};\n\t\t\n\t\tfrms[j-1].dispose = 1;\n\t\tif(j-1!=0) \n\t\tUPNG.encode._updateFrame(bufs, w,h,frms, j-1,r, evenCrd);\n\t\tUPNG.encode._updateFrame(bufs, w,h,frms, j  ,r, evenCrd);\n\t}\n\tvar area = 0;\n\tif(bufs.length!=1) for(var i=0; i<frms.length; i++) {\n\t\tvar frm = frms[i];\n\t\tarea += frm.rect.width*frm.rect.height;\n\t\t//if(i==0 || frm.blend!=1) continue;\n\t\t//var ob = new Uint8Array(\n\t\t//console.log(frm.blend, frm.dispose, frm.rect);\n\t}\n\t//if(area!=0) console.log(area);\n\treturn frms;\n}\nUPNG.encode._updateFrame = function(bufs, w,h, frms, i, r, evenCrd) {\n\tvar U8 = Uint8Array, U32 = Uint32Array;\n\tvar pimg = new U8(bufs[i-1]), pimg32 = new U32(bufs[i-1]), nimg = i+1<bufs.length ? new U8(bufs[i+1]):null;\n\tvar cimg = new U8(bufs[i]), cimg32 = new U32(cimg.buffer);\n\t\n\tvar mix=w,miy=h,max=-1,may=-1;\n\tfor(var y=0; y<r.height; y++) for(var x=0; x<r.width; x++) {\n\t\tvar cx = r.x+x, cy = r.y+y;\n\t\tvar j = cy*w+cx, cc = cimg32[j];\n\t\t// no need to draw transparency, or to dispose it. Or, if writing the same color and the next one does not need transparency.\n\t\tif(cc==0 || (frms[i-1].dispose==0 && pimg32[j]==cc && (nimg==null || nimg[j*4+3]!=0))/**/) {}\n\t\telse {\n\t\t\tif(cx<mix) mix=cx;  if(cx>max) max=cx;\n\t\t\tif(cy<miy) miy=cy;  if(cy>may) may=cy;\n\t\t}\n\t}\n\tif(max==-1) mix=miy=max=may=0;\n\tif(evenCrd) {  if((mix&1)==1)mix--;  if((miy&1)==1)miy--;  }\n\tr = {x:mix, y:miy, width:max-mix+1, height:may-miy+1};\n\t\n\tvar fr = frms[i];  fr.rect = r;  fr.blend = 1;  fr.img = new Uint8Array(r.width*r.height*4);\n\tif(frms[i-1].dispose==0) {\n\t\tUPNG._copyTile(pimg,w,h, fr.img,r.width,r.height, -r.x,-r.y, 0);\n\t\tUPNG.encode._prepareDiff(cimg,w,h,fr.img,r);\n\t\t//UPNG._copyTile(cimg,w,h, fr.img,r.width,r.height, -r.x,-r.y, 2);\n\t}\n\telse\n\t\tUPNG._copyTile(cimg,w,h, fr.img,r.width,r.height, -r.x,-r.y, 0);\n}\nUPNG.encode._prepareDiff = function(cimg, w,h, nimg, rec) {\n\tUPNG._copyTile(cimg,w,h, nimg,rec.width,rec.height, -rec.x,-rec.y, 2);\n\t/*\n\tvar n32 = new Uint32Array(nimg.buffer);\n\tvar og = new Uint8Array(rec.width*rec.height*4), o32 = new Uint32Array(og.buffer);\n\tUPNG._copyTile(cimg,w,h, og,rec.width,rec.height, -rec.x,-rec.y, 0);\n\tfor(var i=4; i<nimg.length; i+=4) {\n\t\tif(nimg[i-1]!=0 && nimg[i+3]==0 && o32[i>>>2]==o32[(i>>>2)-1]) {\n\t\t\tn32[i>>>2]=o32[i>>>2];\n\t\t\t//var j = i, c=p32[(i>>>2)-1];\n\t\t\t//while(p32[j>>>2]==c) {  n32[j>>>2]=c;  j+=4;  }\n\t\t}\n\t}\n\tfor(var i=nimg.length-8; i>0; i-=4) {\n\t\tif(nimg[i+7]!=0 && nimg[i+3]==0 && o32[i>>>2]==o32[(i>>>2)+1]) {\n\t\t\tn32[i>>>2]=o32[i>>>2];\n\t\t\t//var j = i, c=p32[(i>>>2)-1];\n\t\t\t//while(p32[j>>>2]==c) {  n32[j>>>2]=c;  j+=4;  }\n\t\t}\n\t}*/\n}\n\nUPNG.encode._filterZero = function(img,h,bpp,bpl,data, filter, levelZero)\n{\n\tvar fls = [], ftry=[0,1,2,3,4];\n\tif     (filter!=-1)             ftry=[filter];\n\telse if(h*bpl>500000 || bpp==1) ftry=[0];\n\tvar opts;  if(levelZero) opts={level:0};\n\t\n\t\n\tvar CMPR = (data.length>10e6 && UZIP!=null) ? UZIP : pako;\n\t\n\tvar time = Date.now();\n\tfor(var i=0; i<ftry.length; i++) {\n\t\tfor(var y=0; y<h; y++) UPNG.encode._filterLine(data, img, y, bpl, bpp, ftry[i]);\n\t\t//var nimg = new Uint8Array(data.length);\n\t\t//var sz = UZIP.F.deflate(data, nimg);  fls.push(nimg.slice(0,sz));\n\t\t//var dfl = pako[\"deflate\"](data), dl=dfl.length-4;\n\t\t//var crc = (dfl[dl+3]<<24)|(dfl[dl+2]<<16)|(dfl[dl+1]<<8)|(dfl[dl+0]<<0);\n\t\t//console.log(crc, UZIP.adler(data,2,data.length-6));\n\t\tfls.push(CMPR[\"deflate\"](data,opts));\n\t}\n\t\n\tvar ti, tsize=1e9;\n\tfor(var i=0; i<fls.length; i++) if(fls[i].length<tsize) {  ti=i;  tsize=fls[i].length;  }\n\treturn fls[ti];\n}\nUPNG.encode._filterLine = function(data, img, y, bpl, bpp, type)\n{\n\tvar i = y*bpl, di = i+y, paeth = UPNG.decode._paeth\n\tdata[di]=type;  di++;\n\n\tif(type==0) {\n\t\tif(bpl<500) for(var x=0; x<bpl; x++) data[di+x] = img[i+x];\n\t\telse data.set(new Uint8Array(img.buffer,i,bpl),di);\n\t}\n\telse if(type==1) {\n\t\tfor(var x=  0; x<bpp; x++) data[di+x] =  img[i+x];\n\t\tfor(var x=bpp; x<bpl; x++) data[di+x] = (img[i+x]-img[i+x-bpp]+256)&255;\n\t}\n\telse if(y==0) {\n\t\tfor(var x=  0; x<bpp; x++) data[di+x] = img[i+x];\n\n\t\tif(type==2) for(var x=bpp; x<bpl; x++) data[di+x] = img[i+x];\n\t\tif(type==3) for(var x=bpp; x<bpl; x++) data[di+x] = (img[i+x] - (img[i+x-bpp]>>1) +256)&255;\n\t\tif(type==4) for(var x=bpp; x<bpl; x++) data[di+x] = (img[i+x] - paeth(img[i+x-bpp], 0, 0) +256)&255;\n\t}\n\telse {\n\t\tif(type==2) { for(var x=  0; x<bpl; x++) data[di+x] = (img[i+x]+256 - img[i+x-bpl])&255;  }\n\t\tif(type==3) { for(var x=  0; x<bpp; x++) data[di+x] = (img[i+x]+256 - (img[i+x-bpl]>>1))&255;\n\t\t\t\t\t  for(var x=bpp; x<bpl; x++) data[di+x] = (img[i+x]+256 - ((img[i+x-bpl]+img[i+x-bpp])>>1))&255;  }\n\t\tif(type==4) { for(var x=  0; x<bpp; x++) data[di+x] = (img[i+x]+256 - paeth(0, img[i+x-bpl], 0))&255;\n\t\t\t\t\t  for(var x=bpp; x<bpl; x++) data[di+x] = (img[i+x]+256 - paeth(img[i+x-bpp], img[i+x-bpl], img[i+x-bpp-bpl]))&255;  }\n\t}\n}\n\nUPNG.crc = {\n\ttable : ( function() {\n\t   var tab = new Uint32Array(256);\n\t   for (var n=0; n<256; n++) {\n\t\t\tvar c = n;\n\t\t\tfor (var k=0; k<8; k++) {\n\t\t\t\tif (c & 1)  c = 0xedb88320 ^ (c >>> 1);\n\t\t\t\telse        c = c >>> 1;\n\t\t\t}\n\t\t\ttab[n] = c;  }\n\t\treturn tab;  })(),\n\tupdate : function(c, buf, off, len) {\n\t\tfor (var i=0; i<len; i++)  c = UPNG.crc.table[(c ^ buf[off+i]) & 0xff] ^ (c >>> 8);\n\t\treturn c;\n\t},\n\tcrc : function(b,o,l)  {  return UPNG.crc.update(0xffffffff,b,o,l) ^ 0xffffffff;  }\n}\n\n\nUPNG.quantize = function(abuf, ps)\n{\t\n\tvar oimg = new Uint8Array(abuf), nimg = oimg.slice(0), nimg32 = new Uint32Array(nimg.buffer);\n\t\n\tvar KD = UPNG.quantize.getKDtree(nimg, ps);\n\tvar root = KD[0], leafs = KD[1];\n\t\n\tvar planeDst = UPNG.quantize.planeDst;\n\tvar sb = oimg, tb = nimg32, len=sb.length;\n\t\t\n\tvar inds = new Uint8Array(oimg.length>>2), nd;\n\tif(oimg.length<20e6)  // precise, but slow :(\n\t\tfor(var i=0; i<len; i+=4) {\n\t\t\tvar r=sb[i]*(1/255), g=sb[i+1]*(1/255), b=sb[i+2]*(1/255), a=sb[i+3]*(1/255);\n\t\t\t\n\t\t\tnd = UPNG.quantize.getNearest(root, r, g, b, a);\n\t\t\tinds[i>>2] = nd.ind;  tb[i>>2] = nd.est.rgba;\n\t\t}\n\telse \n\t\tfor(var i=0; i<len; i+=4) {\n\t\t\tvar r=sb[i]*(1/255), g=sb[i+1]*(1/255), b=sb[i+2]*(1/255), a=sb[i+3]*(1/255);\n\t\t\t\n\t\t\tnd = root;  while(nd.left) nd = (planeDst(nd.est,r,g,b,a)<=0) ? nd.left : nd.right;\n\t\t\tinds[i>>2] = nd.ind;  tb[i>>2] = nd.est.rgba;\n\t\t}\n\treturn {  abuf:nimg.buffer, inds:inds, plte:leafs  };\n}\n\nUPNG.quantize.getKDtree = function(nimg, ps, err) {\n\tif(err==null) err = 0.0001;\n\tvar nimg32 = new Uint32Array(nimg.buffer);\n\t\n\tvar root = {i0:0, i1:nimg.length, bst:null, est:null, tdst:0, left:null, right:null };  // basic statistic, extra statistic\n\troot.bst = UPNG.quantize.stats(  nimg,root.i0, root.i1  );  root.est = UPNG.quantize.estats( root.bst );\n\tvar leafs = [root];\n\t\n\twhile(leafs.length<ps)\n\t{\n\t\tvar maxL = 0, mi=0;\n\t\tfor(var i=0; i<leafs.length; i++) if(leafs[i].est.L > maxL) {  maxL=leafs[i].est.L;  mi=i;  }\n\t\tif(maxL<err) break;\n\t\tvar node = leafs[mi];\n\t\t\n\t\tvar s0 = UPNG.quantize.splitPixels(nimg,nimg32, node.i0, node.i1, node.est.e, node.est.eMq255);\n\t\tvar s0wrong = (node.i0>=s0 || node.i1<=s0);\n\t\t//console.log(maxL, leafs.length, mi);\n\t\tif(s0wrong) {  node.est.L=0;  continue;  }\n\t\t\n\t\t\n\t\tvar ln = {i0:node.i0, i1:s0, bst:null, est:null, tdst:0, left:null, right:null };  ln.bst = UPNG.quantize.stats( nimg, ln.i0, ln.i1 );  \n\t\tln.est = UPNG.quantize.estats( ln.bst );\n\t\tvar rn = {i0:s0, i1:node.i1, bst:null, est:null, tdst:0, left:null, right:null };  rn.bst = {R:[], m:[], N:node.bst.N-ln.bst.N};\n\t\tfor(var i=0; i<16; i++) rn.bst.R[i] = node.bst.R[i]-ln.bst.R[i];\n\t\tfor(var i=0; i< 4; i++) rn.bst.m[i] = node.bst.m[i]-ln.bst.m[i];\n\t\trn.est = UPNG.quantize.estats( rn.bst );\n\t\t\n\t\tnode.left = ln;  node.right = rn;\n\t\tleafs[mi]=ln;  leafs.push(rn);\n\t}\n\tleafs.sort(function(a,b) {  return b.bst.N-a.bst.N;  });\n\tfor(var i=0; i<leafs.length; i++) leafs[i].ind=i;\n\treturn [root, leafs];\n}\n\nUPNG.quantize.getNearest = function(nd, r,g,b,a)\n{\n\tif(nd.left==null) {  nd.tdst = UPNG.quantize.dist(nd.est.q,r,g,b,a);  return nd;  }\n\tvar planeDst = UPNG.quantize.planeDst(nd.est,r,g,b,a);\n\t\n\tvar node0 = nd.left, node1 = nd.right;\n\tif(planeDst>0) {  node0=nd.right;  node1=nd.left;  }\n\t\n\tvar ln = UPNG.quantize.getNearest(node0, r,g,b,a);\n\tif(ln.tdst<=planeDst*planeDst) return ln;\n\tvar rn = UPNG.quantize.getNearest(node1, r,g,b,a);\n\treturn rn.tdst<ln.tdst ? rn : ln;\n}\nUPNG.quantize.planeDst = function(est, r,g,b,a) {  var e = est.e;  return e[0]*r + e[1]*g + e[2]*b + e[3]*a - est.eMq;  }\nUPNG.quantize.dist     = function(q,   r,g,b,a) {  var d0=r-q[0], d1=g-q[1], d2=b-q[2], d3=a-q[3];  return d0*d0+d1*d1+d2*d2+d3*d3;  }\n\nUPNG.quantize.splitPixels = function(nimg, nimg32, i0, i1, e, eMq)\n{\n\tvar vecDot = UPNG.quantize.vecDot;\n\ti1-=4;\n\tvar shfs = 0;\n\twhile(i0<i1)\n\t{\n\t\twhile(vecDot(nimg, i0, e)<=eMq) i0+=4;\n\t\twhile(vecDot(nimg, i1, e)> eMq) i1-=4;\n\t\tif(i0>=i1) break;\n\t\t\n\t\tvar t = nimg32[i0>>2];  nimg32[i0>>2] = nimg32[i1>>2];  nimg32[i1>>2]=t;\n\t\t\n\t\ti0+=4;  i1-=4;\n\t}\n\twhile(vecDot(nimg, i0, e)>eMq) i0-=4;\n\treturn i0+4;\n}\nUPNG.quantize.vecDot = function(nimg, i, e)\n{\n\treturn nimg[i]*e[0] + nimg[i+1]*e[1] + nimg[i+2]*e[2] + nimg[i+3]*e[3];\n}\nUPNG.quantize.stats = function(nimg, i0, i1){\n\tvar R = [0,0,0,0,  0,0,0,0,  0,0,0,0,  0,0,0,0];\n\tvar m = [0,0,0,0];\n\tvar N = (i1-i0)>>2;\n\tfor(var i=i0; i<i1; i+=4)\n\t{\n\t\tvar r = nimg[i]*(1/255), g = nimg[i+1]*(1/255), b = nimg[i+2]*(1/255), a = nimg[i+3]*(1/255);\n\t\t//var r = nimg[i], g = nimg[i+1], b = nimg[i+2], a = nimg[i+3];\n\t\tm[0]+=r;  m[1]+=g;  m[2]+=b;  m[3]+=a;\n\t\t\n\t\tR[ 0] += r*r;  R[ 1] += r*g;  R[ 2] += r*b;  R[ 3] += r*a;  \n\t\t               R[ 5] += g*g;  R[ 6] += g*b;  R[ 7] += g*a; \n\t\t                              R[10] += b*b;  R[11] += b*a;  \n\t\t                                             R[15] += a*a;  \n\t}\n\tR[4]=R[1];  R[8]=R[2];  R[9]=R[6];  R[12]=R[3];  R[13]=R[7];  R[14]=R[11];\n\t\n\treturn {R:R, m:m, N:N};\n}\nUPNG.quantize.estats = function(stats){\n\tvar R = stats.R, m = stats.m, N = stats.N;\n\t\n\t// when all samples are equal, but N is large (millions), the Rj can be non-zero ( 0.0003.... - precission error)\n\tvar m0 = m[0], m1 = m[1], m2 = m[2], m3 = m[3], iN = (N==0 ? 0 : 1/N);\n\tvar Rj = [\n\t\tR[ 0] - m0*m0*iN,  R[ 1] - m0*m1*iN,  R[ 2] - m0*m2*iN,  R[ 3] - m0*m3*iN,  \n\t\tR[ 4] - m1*m0*iN,  R[ 5] - m1*m1*iN,  R[ 6] - m1*m2*iN,  R[ 7] - m1*m3*iN,\n\t\tR[ 8] - m2*m0*iN,  R[ 9] - m2*m1*iN,  R[10] - m2*m2*iN,  R[11] - m2*m3*iN,  \n\t\tR[12] - m3*m0*iN,  R[13] - m3*m1*iN,  R[14] - m3*m2*iN,  R[15] - m3*m3*iN \n\t];\n\t\n\tvar A = Rj, M = UPNG.M4;\n\tvar b = [0.5,0.5,0.5,0.5], mi = 0, tmi = 0;\n\t\n\tif(N!=0)\n\tfor(var i=0; i<16; i++) {\n\t\tb = M.multVec(A, b);  tmi = Math.sqrt(M.dot(b,b));  b = M.sml(1/tmi,  b);\n\t\tif(i!=0 && Math.abs(tmi-mi)<1e-9) break;  mi = tmi;\n\t}\t\n\t//b = [0,0,1,0];  mi=N;\n\tvar q = [m0*iN, m1*iN, m2*iN, m3*iN];\n\tvar eMq255 = M.dot(M.sml(255,q),b);\n\t\n\treturn {  Cov:Rj, q:q, e:b, L:mi,  eMq255:eMq255, eMq : M.dot(b,q),\n\t\t\t\trgba: (((Math.round(255*q[3])<<24) | (Math.round(255*q[2])<<16) |  (Math.round(255*q[1])<<8) | (Math.round(255*q[0])<<0))>>>0)  };\n}\nUPNG.M4 = {\n\tmultVec : function(m,v) {\n\t\t\treturn [\n\t\t\t\tm[ 0]*v[0] + m[ 1]*v[1] + m[ 2]*v[2] + m[ 3]*v[3],\n\t\t\t\tm[ 4]*v[0] + m[ 5]*v[1] + m[ 6]*v[2] + m[ 7]*v[3],\n\t\t\t\tm[ 8]*v[0] + m[ 9]*v[1] + m[10]*v[2] + m[11]*v[3],\n\t\t\t\tm[12]*v[0] + m[13]*v[1] + m[14]*v[2] + m[15]*v[3]\n\t\t\t];\n\t},\n\tdot : function(x,y) {  return  x[0]*y[0]+x[1]*y[1]+x[2]*y[2]+x[3]*y[3];  },\n\tsml : function(a,y) {  return [a*y[0],a*y[1],a*y[2],a*y[3]];  }\n}\n\nUPNG.encode.concatRGBA = function(bufs) {\n\tvar tlen = 0;\n\tfor(var i=0; i<bufs.length; i++) tlen += bufs[i].byteLength;\n\tvar nimg = new Uint8Array(tlen), noff=0;\n\tfor(var i=0; i<bufs.length; i++) {\n\t\tvar img = new Uint8Array(bufs[i]), il = img.length;\n\t\tfor(var j=0; j<il; j+=4) {  \n\t\t\tvar r=img[j], g=img[j+1], b=img[j+2], a = img[j+3];\n\t\t\tif(a==0) r=g=b=0;\n\t\t\tnimg[noff+j]=r;  nimg[noff+j+1]=g;  nimg[noff+j+2]=b;  nimg[noff+j+3]=a;  }\n\t\tnoff += il;\n\t}\n\treturn nimg.buffer;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\n * Copyright (c) 2019 Joerg Breitbart.\n * @license MIT\n */\n\nimport { RGBA8888, RGBColor } from './Types';\n\n\n// FIXME: cleanup this mess, move things either to decoder/encoder, keep only shared things\n\n\n// system endianess\nexport const BIG_ENDIAN = new Uint8Array(new Uint32Array([0xFF000000]).buffer)[0] === 0xFF;\nif (BIG_ENDIAN) {\n  console.warn('BE platform detected. This version of node-sixel works only on LE properly.');\n}\n\n// channel values\nexport function red(n: RGBA8888): number {\n  return n & 0xFF;\n}\n\nexport function green(n: RGBA8888): number {\n  return (n >>> 8) & 0xFF;\n}\n\nexport function blue(n: RGBA8888): number {\n  return (n >>> 16) & 0xFF;\n}\n\nexport function alpha(n: RGBA8888): number {\n  return (n >>> 24) & 0xFF;\n}\n\n\n/**\n * Convert RGB channels to native color RGBA8888.\n */\nexport function toRGBA8888(r: number, g: number, b: number, a: number = 255): RGBA8888 {\n  return ((a & 0xFF) << 24 | (b & 0xFF) << 16 | (g & 0xFF) << 8 | (r & 0xFF)) >>> 0;   // ABGR32\n}\n\n\n/**\n * Convert native color to [r, g, b, a].\n */\nexport function fromRGBA8888(color: RGBA8888): [number, number, number, number] {\n  return [color & 0xFF, (color >> 8) & 0xFF, (color >> 16) & 0xFF, color >>> 24];\n}\n\n\n/**\n * Get index of nearest color in `palette` for `color`.\n * Uses euclidean distance without any luminescence correction.\n */\nexport function nearestColorIndex(color: RGBA8888, palette: RGBColor[]): number {\n  const r = red(color);\n  const g = green(color);\n  const b = blue(color);\n\n  let min = Number.MAX_SAFE_INTEGER;\n  let idx = -1;\n\n  // use euclidean distance (manhattan gives very poor results)\n  for (let i = 0; i < palette.length; ++i) {\n    const dr = r - palette[i][0];\n    const dg = g - palette[i][1];\n    const db = b - palette[i][2];\n    const d = dr * dr + dg * dg + db * db;\n    if (!d) return i;\n    if (d < min) {\n      min = d;\n      idx = i;\n    }\n  }\n\n  return idx;\n}\n\n\n// color conversions\n// HLS taken from: http://www.niwa.nu/2013/05/math-behind-colorspace-conversions-rgb-hsl\n\nfunction clamp(low: number, high: number, value: number): number {\n  return Math.max(low, Math.min(value, high));\n}\n\nfunction h2c(t1: number, t2: number, c: number): number {\n  if (c < 0) c += 1;\n  if (c > 1) c -= 1;\n  return c * 6 < 1\n    ? t2 + (t1 - t2) * 6 * c\n    : c * 2 < 1\n      ? t1\n      : c * 3 < 2\n        ? t2 + (t1 - t2) * (4 - c * 6)\n        : t2;\n}\n\nfunction HLStoRGB(h: number, l: number, s: number): RGBA8888 {\n  if (!s) {\n    const v = Math.round(l * 255);\n    return toRGBA8888(v, v, v);\n  }\n  const t1 = l < 0.5 ? l * (1 + s) : l + s - l * s;\n  const t2 = 2 * l - t1;\n  return toRGBA8888(\n    clamp(0, 255, Math.round(h2c(t1, t2, h + 1 / 3) * 255)),\n    clamp(0, 255, Math.round(h2c(t1, t2, h) * 255)),\n    clamp(0, 255, Math.round(h2c(t1, t2, h - 1 / 3) * 255))\n  );\n}\n\n/**\n * Normalize SIXEL RGB values (percent based, 0-100) to RGBA8888.\n */\nexport function normalizeRGB(r: number, g: number, b: number): RGBA8888 {\n  return (0xFF000000 | Math.round(b / 100 * 255) << 16 | Math.round(g / 100 * 255) << 8 | Math.round(r / 100 * 255)) >>> 0;  // ABGR32\n}\n\n\n/**\n * Normalize SIXEL HLS values to RGBA8888. Applies hue correction of +240.\n */\nexport function normalizeHLS(h: number, l: number, s: number): RGBA8888 {\n  // Note: hue value is turned by 240 in VT340, all values given as fractions\n  return HLStoRGB((h + 240 % 360) / 360, l / 100, s / 100);\n}\n\n\n/**\n * default palettes\n */\n\n// FIXME: move palettes to Decoder.ts\n\n/**\n * 16 predefined color registers of VT340 (values in %):\n * ```\n *                R   G   B\n * 0  Black       0   0   0\n * 1  Blue        20  20  80\n * 2  Red         80  13  13\n * 3  Green       20  80  20\n * 4  Magenta     80  20  80\n * 5  Cyan        20  80  80\n * 6  Yellow      80  80  20\n * 7  Gray 50%    53  53  53\n * 8  Gray 25%    26  26  26\n * 9  Blue*       33  33  60\n * 10 Red*        60  26  26\n * 11 Green*      33  60  33\n * 12 Magenta*    60  33  60\n * 13 Cyan*       33  60  60\n * 14 Yellow*     60  60  33\n * 15 Gray 75%    80  80  80\n * ```\n * (*) less saturated\n *\n * @see https://vt100.net/docs/vt3xx-gp/chapter2.html#S2.4\n*/\nexport const PALETTE_VT340_COLOR = new Uint32Array([\n  normalizeRGB( 0,  0,  0),\n  normalizeRGB(20, 20, 80),\n  normalizeRGB(80, 13, 13),\n  normalizeRGB(20, 80, 20),\n  normalizeRGB(80, 20, 80),\n  normalizeRGB(20, 80, 80),\n  normalizeRGB(80, 80, 20),\n  normalizeRGB(53, 53, 53),\n  normalizeRGB(26, 26, 26),\n  normalizeRGB(33, 33, 60),\n  normalizeRGB(60, 26, 26),\n  normalizeRGB(33, 60, 33),\n  normalizeRGB(60, 33, 60),\n  normalizeRGB(33, 60, 60),\n  normalizeRGB(60, 60, 33),\n  normalizeRGB(80, 80, 80)\n]);\n\n/**\n * 16 predefined monochrome registers of VT340 (values in %):\n * ```\n *              R   G   B\n * 0  Black     0   0   0\n * 1  Gray-2    13  13  13\n * 2  Gray-4    26  26  26\n * 3  Gray-6    40  40  40\n * 4  Gray-1    6   6   6\n * 5  Gray-3    20  20  20\n * 6  Gray-5    33  33  33\n * 7  White 7   46  46  46\n * 8  Black 0   0   0   0\n * 9  Gray-2    13  13  13\n * 10 Gray-4    26  26  26\n * 11 Gray-6    40  40  40\n * 12 Gray-1    6   6   6\n * 13 Gray-3    20  20  20\n * 14 Gray-5    33  33  33\n * 15 White 7   46  46  46\n * ```\n *\n * @see https://vt100.net/docs/vt3xx-gp/chapter2.html#S2.4\n */\nexport const PALETTE_VT340_GREY = new Uint32Array([\n  normalizeRGB( 0,  0,  0),\n  normalizeRGB(13, 13, 13),\n  normalizeRGB(26, 26, 26),\n  normalizeRGB(40, 40, 40),\n  normalizeRGB( 6,  6,  6),\n  normalizeRGB(20, 20, 20),\n  normalizeRGB(33, 33, 33),\n  normalizeRGB(46, 46, 46),\n  normalizeRGB( 0,  0,  0),\n  normalizeRGB(13, 13, 13),\n  normalizeRGB(26, 26, 26),\n  normalizeRGB(40, 40, 40),\n  normalizeRGB( 6,  6,  6),\n  normalizeRGB(20, 20, 20),\n  normalizeRGB(33, 33, 33),\n  normalizeRGB(46, 46, 46)\n]);\n\n/**\n * 256 predefined ANSI colors.\n *\n * @see https://en.wikipedia.org/wiki/ANSI_escape_code#8-bit\n */\nexport const PALETTE_ANSI_256 = (() => {\n  // 16 lower colors (taken from xterm)\n  const p: RGBA8888[] = [\n    toRGBA8888(0, 0, 0),\n    toRGBA8888(205, 0, 0),\n    toRGBA8888(0, 205, 0),\n    toRGBA8888(205, 205, 0),\n    toRGBA8888(0, 0, 238),\n    toRGBA8888(205, 0, 205),\n    toRGBA8888(0, 250, 205),\n    toRGBA8888(229, 229, 229),\n    toRGBA8888(127, 127, 127),\n    toRGBA8888(255, 0, 0),\n    toRGBA8888(0, 255, 0),\n    toRGBA8888(255, 255, 0),\n    toRGBA8888(92, 92, 255),\n    toRGBA8888(255, 0, 255),\n    toRGBA8888(0, 255, 255),\n    toRGBA8888(255, 255, 255),\n  ];\n  // colors up to 232\n  const d = [0, 95, 135, 175, 215, 255];\n  for (let r = 0; r < 6; ++r) {\n    for (let g = 0; g < 6; ++g) {\n      for (let b = 0; b < 6; ++b) {\n        p.push(toRGBA8888(d[r], d[g], d[b]));\n      }\n    }\n  }\n  // grey scale to up 255\n  for (let v = 8; v <= 238; v += 10) {\n    p.push(toRGBA8888(v, v, v));\n  }\n  return new Uint32Array(p);\n})();\n\n/**\n * Background: Black by default.\n * Foreground: White by default.\n *\n * Background color is used whenever a fill color is needed and not explicitly set.\n * Foreground color is used as default initial sixel color.\n */\nexport const DEFAULT_BACKGROUND: RGBA8888 = toRGBA8888(0, 0, 0, 255);\nexport const DEFAULT_FOREGROUND: RGBA8888 = toRGBA8888(255, 255, 255, 255);\n","\nexport const LIMITS = {\n  CHUNK_SIZE: 16384,\n  PALETTE_SIZE: 4096,\n  MAX_WIDTH: 16384,\n  BYTES: 'AGFzbQEAAAABJAdgAAF/YAJ/fwBgA39/fwF/YAF/AX9gAABgBH9/f38AYAF/AAIlAgNlbnYLaGFuZGxlX2JhbmQAAwNlbnYLbW9kZV9wYXJzZWQAAwMTEgQAAAAAAQQBAQUBAAACAgAGAwQFAXABBwcFBAEBBwcGCAF/AUGAihoLB9wBDgZtZW1vcnkCABFnZXRfc3RhdGVfYWRkcmVzcwADEWdldF9jaHVua19hZGRyZXNzAAQOZ2V0X3AwX2FkZHJlc3MABRNnZXRfcGFsZXR0ZV9hZGRyZXNzAAYEaW5pdAALBmRlY29kZQAMDWN1cnJlbnRfd2lkdGgADQ5jdXJyZW50X2hlaWdodAAOGV9faW5kaXJlY3RfZnVuY3Rpb25fdGFibGUBAAtfaW5pdGlhbGl6ZQACCXN0YWNrU2F2ZQARDHN0YWNrUmVzdG9yZQASCnN0YWNrQWxsb2MAEwkMAQBBAQsGCgcJDxACDAEBCq5UEgMAAQsFAEGgCAsGAEGQiQELBgBBsIkCCwUAQZAJC+okAQh/QeQIKAIAIQVB4AgoAgAhA0HoCCgCACEIIAFBkIkBaiIJQf8BOgAAIAAgAUgEQCAAQZCJAWohBgNAIAMhBCAGQQFqIQECQCAGLQAAQf8AcSIDQTBrQQlLBEAgASEGDAELQewIKAIAQQJ0QewIaiICKAIAIQADQCACIAMgAEEKbGpBMGsiADYCACABLQAAIQMgAUEBaiIGIQEgA0H/AHEiA0Ewa0EKSQ0ACwsCQAJAAkACQAJAAkACQAJ/AkACQCADQT9rIgBBP00EQCAERQ0BIARBIUYEQAJAQfAIKAIAIgFBASABGyIHIAhqIgFB1AgoAgAiA0gNACADQf//AEoNAANAIANBAnQiAkGgiQJqIgRBoAgpAwA3AwAgAkGoiQJqQaAIKQMANwMAIAJBsIkCakGgCCkDADcDACACQbiJAmpBoAgpAwA3AwAgAkHAiQJqQaAIKQMANwMAIAJByIkCakGgCCkDADcDACACQdCJAmpBoAgpAwA3AwAgAkHYiQJqQaAIKQMANwMAIAJB4IkCakGgCCkDADcDACACQeiJAmpBoAgpAwA3AwAgAkHwiQJqQaAIKQMANwMAIAJB+IkCakGgCCkDADcDACACQYCKAmpBoAgpAwA3AwAgAkGIigJqQaAIKQMANwMAIAJBkIoCakGgCCkDADcDACACQZiKAmpBoAgpAwA3AwAgAkGgigJqQaAIKQMANwMAIAJBqIoCakGgCCkDADcDACACQbCKAmpBoAgpAwA3AwAgAkG4igJqQaAIKQMANwMAIAJBwIoCakGgCCkDADcDACACQciKAmpBoAgpAwA3AwAgAkHQigJqQaAIKQMANwMAIAJB2IoCakGgCCkDADcDACACQeCKAmpBoAgpAwA3AwAgAkHoigJqQaAIKQMANwMAIAJB8IoCakGgCCkDADcDACACQfiKAmpBoAgpAwA3AwAgAkGAiwJqQaAIKQMANwMAIAJBiIsCakGgCCkDADcDACACQZCLAmpBoAgpAwA3AwAgAkGYiwJqQaAIKQMANwMAIAJBoIsCakGgCCkDADcDACACQaiLAmpBoAgpAwA3AwAgAkGwiwJqQaAIKQMANwMAIAJBuIsCakGgCCkDADcDACACQcCLAmpBoAgpAwA3AwAgAkHIiwJqQaAIKQMANwMAIAJB0IsCakGgCCkDADcDACACQdiLAmpBoAgpAwA3AwAgAkHgiwJqQaAIKQMANwMAIAJB6IsCakGgCCkDADcDACACQfCLAmpBoAgpAwA3AwAgAkH4iwJqQaAIKQMANwMAIAJBgIwCakGgCCkDADcDACACQYiMAmpBoAgpAwA3AwAgAkGQjAJqQaAIKQMANwMAIAJBmIwCakGgCCkDADcDACACQaCMAmpBoAgpAwA3AwAgAkGojAJqQaAIKQMANwMAIAJBsIwCakGgCCkDADcDACACQbiMAmpBoAgpAwA3AwAgAkHAjAJqQaAIKQMANwMAIAJByIwCakGgCCkDADcDACACQdCMAmpBoAgpAwA3AwAgAkHYjAJqQaAIKQMANwMAIAJB4IwCakGgCCkDADcDACACQeiMAmpBoAgpAwA3AwAgAkHwjAJqQaAIKQMANwMAIAJB+IwCakGgCCkDADcDACACQYCNAmpBoAgpAwA3AwAgAkGIjQJqQaAIKQMANwMAIAJBkI0CakGgCCkDADcDACACQZiNAmpBoAgpAwA3AwAgAkGwiQZqIARBgAT8CgAAQdQIKAIAQQJ0QcCJCmogBEGABPwKAABB1AgoAgBBAnRB0IkOaiAEQYAE/AoAAEHUCCgCAEECdEHgiRJqIARBgAT8CgAAQdQIKAIAQQJ0QfCJFmogBEGABPwKAABB1AhB1AgoAgAiAkGAAWoiAzYCACABIANIDQEgAkGA/wBIDQALCwJAIABFDQAgCEH//wBLDQBBgIABIAhrIAcgAUH//wBLGyECAkAgAEEBcUUNACACRQ0AIAhBAnRBoIkCaiEDIAIhBCACQQdxIgcEQANAIAMgBTYCACADQQRqIQMgBEEBayEEIAdBAWsiBw0ACwsgAkEBa0EHSQ0AA0AgAyAFNgIcIAMgBTYCGCADIAU2AhQgAyAFNgIQIAMgBTYCDCADIAU2AgggAyAFNgIEIAMgBTYCACADQSBqIQMgBEEIayIEDQALCwJAIABBAnFFDQAgAkUNACAIQQJ0QbCJBmohAyACIQQgAkEHcSIHBEADQCADIAU2AgAgA0EEaiEDIARBAWshBCAHQQFrIgcNAAsLIAJBAWtBB0kNAANAIAMgBTYCHCADIAU2AhggAyAFNgIUIAMgBTYCECADIAU2AgwgAyAFNgIIIAMgBTYCBCADIAU2AgAgA0EgaiEDIARBCGsiBA0ACwsCQCAAQQRxRQ0AIAJFDQAgCEECdEHAiQpqIQMgAiEEIAJBB3EiBwRAA0AgAyAFNgIAIANBBGohAyAEQQFrIQQgB0EBayIHDQALCyACQQFrQQdJDQADQCADIAU2AhwgAyAFNgIYIAMgBTYCFCADIAU2AhAgAyAFNgIMIAMgBTYCCCADIAU2AgQgAyAFNgIAIANBIGohAyAEQQhrIgQNAAsLAkAgAEEIcUUNACACRQ0AIAhBAnRB0IkOaiEDIAIhBCACQQdxIgcEQANAIAMgBTYCACADQQRqIQMgBEEBayEEIAdBAWsiBw0ACwsgAkEBa0EHSQ0AA0AgAyAFNgIcIAMgBTYCGCADIAU2AhQgAyAFNgIQIAMgBTYCDCADIAU2AgggAyAFNgIEIAMgBTYCACADQSBqIQMgBEEIayIEDQALCwJAIABBEHFFDQAgAkUNACAIQQJ0QeCJEmohAyACIQQgAkEHcSIHBEADQCADIAU2AgAgA0EEaiEDIARBAWshBCAHQQFrIgcNAAsLIAJBAWtBB0kNAANAIAMgBTYCHCADIAU2AhggAyAFNgIUIAMgBTYCECADIAU2AgwgAyAFNgIIIAMgBTYCBCADIAU2AgAgA0EgaiEDIARBCGsiBA0ACwsgAEEgcUUNACACRQ0AIAJBAWshByAIQQJ0QfCJFmohAyACQQdxIgQEQANAIAMgBTYCACADQQRqIQMgAkEBayECIARBAWsiBA0ACwsgB0EHSQ0AA0AgAyAFNgIcIAMgBTYCGCADIAU2AhQgAyAFNgIQIAMgBTYCDCADIAU2AgggAyAFNgIEIAMgBTYCACADQSBqIQMgAkEIayICDQALC0HcCEHcCCgCACAAcjYCACAGQQFqIgIgBi0AAEH/AHEiA0E/ayIAQT9LDQQaDAMLAkBB7AgoAgAiBEEBRgRAQfAIKAIAIgNBzAgoAgAiAUkNASADIAFwIQMMAQtB+AgoAgAhAkH0CCgCACEBAkACQCAEQQVHDQAgAUEBRw0AIAJB6QJODQQMAQsgAkHkAEoNA0H8CCgCAEHkAEoNA0GACSgCAEHkAEoNAwsCQCABRQ0AIAFBAkoNACACQfwIKAIAQYAJKAIAIAFBAnRBiAhqKAIAEQIAIQFB8AgoAgAiA0HMCCgCACICTwR/IAMgAnAFIAMLQQJ0QZAJaiABNgIAC0HwCCgCACIDQcwIKAIAIgFJDQAgAyABcCEDCyADQQJ0QZAJaigCACEFDAELIANB/QBxQSFHBEAgCCEBIAYhAgwECyAEQSNHDQQCQEHsCCgCACICQQFGBEBB8AgoAgAiAUHMCCgCACIASQ0BIAEgAHAhAQwBC0H4CCgCACEBQfQIKAIAIQACQAJAIAJBBUcNACAAQQFHDQAgAUHpAkgNAQwHCyABQeQASg0GQfwIKAIAQeQASg0GQYAJKAIAQeQASg0GCwJAIABFDQAgAEECSg0AIAFB/AgoAgBBgAkoAgAgAEECdEGICGooAgARAgAhAEHwCCgCACIBQcwIKAIAIgJPBH8gASACcAUgAQtBAnRBkAlqIAA2AgALQfAIKAIAIgFBzAgoAgAiAEkNACABIABwIQELIAFBAnRBkAlqKAIAIQUMBAsgCCEBIAYhAgtB1AgoAgAhBgNAAkAgASAGSA0AIAZB//8ASg0AIAZBAnQiBEGgiQJqIgZBoAgpAwA3AwAgBEGoiQJqQaAIKQMANwMAIARBsIkCakGgCCkDADcDACAEQbiJAmpBoAgpAwA3AwAgBEHAiQJqQaAIKQMANwMAIARByIkCakGgCCkDADcDACAEQdCJAmpBoAgpAwA3AwAgBEHYiQJqQaAIKQMANwMAIARB4IkCakGgCCkDADcDACAEQeiJAmpBoAgpAwA3AwAgBEHwiQJqQaAIKQMANwMAIARB+IkCakGgCCkDADcDACAEQYCKAmpBoAgpAwA3AwAgBEGIigJqQaAIKQMANwMAIARBkIoCakGgCCkDADcDACAEQZiKAmpBoAgpAwA3AwAgBEGgigJqQaAIKQMANwMAIARBqIoCakGgCCkDADcDACAEQbCKAmpBoAgpAwA3AwAgBEG4igJqQaAIKQMANwMAIARBwIoCakGgCCkDADcDACAEQciKAmpBoAgpAwA3AwAgBEHQigJqQaAIKQMANwMAIARB2IoCakGgCCkDADcDACAEQeCKAmpBoAgpAwA3AwAgBEHoigJqQaAIKQMANwMAIARB8IoCakGgCCkDADcDACAEQfiKAmpBoAgpAwA3AwAgBEGAiwJqQaAIKQMANwMAIARBiIsCakGgCCkDADcDACAEQZCLAmpBoAgpAwA3AwAgBEGYiwJqQaAIKQMANwMAIARBoIsCakGgCCkDADcDACAEQaiLAmpBoAgpAwA3AwAgBEGwiwJqQaAIKQMANwMAIARBuIsCakGgCCkDADcDACAEQcCLAmpBoAgpAwA3AwAgBEHIiwJqQaAIKQMANwMAIARB0IsCakGgCCkDADcDACAEQdiLAmpBoAgpAwA3AwAgBEHgiwJqQaAIKQMANwMAIARB6IsCakGgCCkDADcDACAEQfCLAmpBoAgpAwA3AwAgBEH4iwJqQaAIKQMANwMAIARBgIwCakGgCCkDADcDACAEQYiMAmpBoAgpAwA3AwAgBEGQjAJqQaAIKQMANwMAIARBmIwCakGgCCkDADcDACAEQaCMAmpBoAgpAwA3AwAgBEGojAJqQaAIKQMANwMAIARBsIwCakGgCCkDADcDACAEQbiMAmpBoAgpAwA3AwAgBEHAjAJqQaAIKQMANwMAIARByIwCakGgCCkDADcDACAEQdCMAmpBoAgpAwA3AwAgBEHYjAJqQaAIKQMANwMAIARB4IwCakGgCCkDADcDACAEQeiMAmpBoAgpAwA3AwAgBEHwjAJqQaAIKQMANwMAIARB+IwCakGgCCkDADcDACAEQYCNAmpBoAgpAwA3AwAgBEGIjQJqQaAIKQMANwMAIARBkI0CakGgCCkDADcDACAEQZiNAmpBoAgpAwA3AwAgBEGwiQZqIAZBgAT8CgAAQdQIKAIAQQJ0QcCJCmogBkGABPwKAABB1AgoAgBBAnRB0IkOaiAGQYAE/AoAAEHUCCgCAEECdEHgiRJqIAZBgAT8CgAAQdQIKAIAQQJ0QfCJFmogBkGABPwKAABB1AhB1AgoAgBBgAFqIgY2AgALIAFB//8ATQRAIABBAXEgAWxBAnRBoIkCaiAFNgIAIABBAXZBAXEgAWxBAnRBsIkGaiAFNgIAIABBAnZBAXEgAWxBAnRBwIkKaiAFNgIAIABBA3ZBAXEgAWxBAnRB0IkOaiAFNgIAIABBBHZBAXEgAWxBAnRB4IkSaiAFNgIAIABBBXYgAWxBAnRB8IkWaiAFNgIAQdQIKAIAIQYLIAFBAWohAUHcCEHcCCgCACAAcjYCACACLQAAIQAgAkEBaiIEIQIgAEH/AHEiA0E/ayIAQcAASQ0ACyAECyECQQAhBCACIQYgASEIIANB/QBxQSFGDQELIANBJGsOCgEDAwMDAwMDAwIDC0HsCEIBNwIADAQLQdgIIAFB2AgoAgAiACAAIAFIGyIAQYCAASAAQYCAAUgbNgIADAILQegIIAFB2AgoAgAiACAAIAFIGyIAQYCAASAAQYCAAUgbIgA2AgBB2AggADYCACAAQQRrEAAEQEHoCEEENgIAQdgIQQQ2AgBB0AhBATYCAA8LEAgMAQsCQCADQTtHDQBB7AgoAgAiAEEHSg0AQewIIABBAWo2AgAgAEECdEHwCGpBADYCAAsgAiEGIAQhAyABIQgMAQtBBCEIIAIhBiAEIQMLIAYgCUkNAAsLQeQIIAU2AgBB4AggAzYCAEHoCCAINgIAC9ELAgF+CH9B2AhCBDcDAEGojQJBoAgpAwAiADcDAEGgjQIgADcDAEGYjQIgADcDAEGQjQIgADcDAEGIjQIgADcDAEGAjQIgADcDAEH4jAIgADcDAEHwjAIgADcDAEHojAIgADcDAEHgjAIgADcDAEHYjAIgADcDAEHQjAIgADcDAEHIjAIgADcDAEHAjAIgADcDAEG4jAIgADcDAEGwjAIgADcDAEGojAIgADcDAEGgjAIgADcDAEGYjAIgADcDAEGQjAIgADcDAEGIjAIgADcDAEGAjAIgADcDAEH4iwIgADcDAEHwiwIgADcDAEHoiwIgADcDAEHgiwIgADcDAEHYiwIgADcDAEHQiwIgADcDAEHIiwIgADcDAEHAiwIgADcDAEG4iwIgADcDAEGwiwIgADcDAEGoiwIgADcDAEGgiwIgADcDAEGYiwIgADcDAEGQiwIgADcDAEGIiwIgADcDAEGAiwIgADcDAEH4igIgADcDAEHwigIgADcDAEHoigIgADcDAEHgigIgADcDAEHYigIgADcDAEHQigIgADcDAEHIigIgADcDAEHAigIgADcDAEG4igIgADcDAEGwigIgADcDAEGoigIgADcDAEGgigIgADcDAEGYigIgADcDAEGQigIgADcDAEGIigIgADcDAEGAigIgADcDAEH4iQIgADcDAEHwiQIgADcDAEHoiQIgADcDAEHgiQIgADcDAEHYiQIgADcDAEHQiQIgADcDAEHIiQIgADcDAEHAiQIgADcDAEG4iQIgADcDAEGwiQIgADcDAEGoCCgCACIEQf8AakGAAW0hCAJAIARBgQFIDQBBASEBIAhBAiAIQQJKG0EBayICQQFxIQMgBEGBAk4EQCACQX5xIQIDQCABQQl0IgdBEHJBoIkCakGwiQJBgAT8CgAAIAdBsI0CakGwiQJBgAT8CgAAIAFBAmohASACQQJrIgINAAsLIANFDQAgAUEJdEEQckGgiQJqQbCJAkGABPwKAAALAkAgBEEBSA0AIAhBASAIQQFKGyIDQQFxIQUCQCADQQFrIgdFBEBBACEBDAELIANB/v///wdxIQJBACEBA0AgAUEJdCIGQRByQbCJBmpBsIkCQYAE/AoAACAGQZAEckGwiQZqQbCJAkGABPwKAAAgAUECaiEBIAJBAmsiAg0ACwsgBQRAIAFBCXRBEHJBsIkGakGwiQJBgAT8CgAACyAEQQFIDQAgA0EBcSEFIAcEfyADQf7///8HcSECQQAhAQNAIAFBCXQiBkEQckHAiQpqQbCJAkGABPwKAAAgBkGQBHJBwIkKakGwiQJBgAT8CgAAIAFBAmohASACQQJrIgINAAsgAUEHdEEEcgVBBAshASAFBEAgAUECdEHAiQpqQbCJAkGABPwKAAALIARBAUgNACADQQFxIQUgBwR/IANB/v///wdxIQJBACEBA0AgAUEJdCIGQRByQdCJDmpBsIkCQYAE/AoAACAGQZAEckHQiQ5qQbCJAkGABPwKAAAgAUECaiEBIAJBAmsiAg0ACyABQQd0QQRyBUEECyEBIAUEQCABQQJ0QdCJ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'\n};\n","/**\n * Copyright (c) 2021 Joerg Breitbart.\n * @license MIT\n */\n\nimport { IDecodeResult, InstanceLike, IDecoderOptions, IDecoderOptionsInternal, IWasmDecoderExports, RGBA8888, UintTypedArray, ParseMode, IDecoderProperties, IWasmDecoder } from './Types';\nimport { DEFAULT_BACKGROUND, DEFAULT_FOREGROUND, PALETTE_VT340_COLOR } from './Colors';\nimport { LIMITS } from './wasm';\n\n\n/* istanbul ignore next */\nfunction decodeBase64(s: string): Uint8Array {\n  if (typeof Buffer !== 'undefined') {\n    return Buffer.from(s, 'base64');\n  }\n  const bytestring = atob(s);\n  const result = new Uint8Array(bytestring.length);\n  for (let i = 0; i < result.length; ++i) {\n    result[i] = bytestring.charCodeAt(i);\n  }\n  return result;\n}\n\nconst WASM_BYTES = decodeBase64(LIMITS.BYTES);\nlet WASM_MODULE: WebAssembly.Module | undefined;\n\n// empty canvas\nconst NULL_CANVAS = new Uint32Array();\n\n\n// proxy for lazy binding of decoder methods to wasm env callbacks\nclass CallbackProxy {\n  public bandHandler = (width: number) => 1;\n  public modeHandler = (mode: ParseMode) => 1;\n  public handle_band(width: number): number {\n    return this.bandHandler(width);\n  }\n  public mode_parsed(mode: number): number {\n    return this.modeHandler(mode);\n  }\n}\n\n\n// default decoder options\nconst DEFAULT_OPTIONS: IDecoderOptionsInternal = {\n  memoryLimit: 2048 * 65536,\n  sixelColor: DEFAULT_FOREGROUND,\n  fillColor: DEFAULT_BACKGROUND,\n  palette: PALETTE_VT340_COLOR,\n  paletteLimit: LIMITS.PALETTE_SIZE,\n  truncate: true\n};\n\n\n/**\n * Create a decoder instance asynchronously.\n * To be used in the browser main thread.\n */\nexport function DecoderAsync(opts?: IDecoderOptions): Promise<Decoder> {\n  const cbProxy = new CallbackProxy();\n  const importObj = {\n    env: {\n      handle_band: cbProxy.handle_band.bind(cbProxy),\n      mode_parsed: cbProxy.mode_parsed.bind(cbProxy)\n    }\n  };\n  return WebAssembly.instantiate(WASM_MODULE || WASM_BYTES, importObj)\n    .then((inst: InstanceLike) => {\n      WASM_MODULE = WASM_MODULE || inst.module;\n      return new Decoder(opts, inst.instance || inst, cbProxy);\n    });\n}\n\n\n/**\n * Decoder - web assembly based sixel stream decoder.\n *\n * Usage pattern:\n *  - call `init` to initialize decoder for new image\n *  - feed data chunks to `decode` or `decodeString`\n *  - grab pixels from `data32`\n *  - optional: call `release` to free memory (e.g. after big images)\n *  - start over with next image by calling `init`\n *\n * Properties:\n *  - max width of 2^14 - 4 pixels (compile time setting in wasm)\n *  - no explicit height limit (only limited by memory)\n *  - max 4096 colors palette (compile time setting in wasm)\n *\n * Explanation operation modes:\n * - M1   Mode chosen for level 1 images (no raster attributes),\n *        or for level 2 images with `truncate=false`.\n * - M2   Mode chosen for level 2 images with `truncate=true` (default).\n *        While this mode is not fully spec conform (decoder not expected to truncate),\n *        it is what spec conform encoders should create (should not excess raster).\n *        This mode has several advantages:\n *        - ~15% faster decoding speed\n *        - image dimensions can be evaluated early without processing the whole data\n *        - faster pixel access in `data32` (precalulated)\n *        - image height is not reported as multiple of 6 pixels\n * - M0   Undecided mode state after `init`.\n * The level of an image is determined during early decoding based on the fact,\n * whether the data contains valid raster attributes before any sixel data.\n * Until then the mode of an image is marked as M0, meaning the real operation mode\n * could not be decided yet.\n */\nexport class Decoder {\n  private _opts: IDecoderOptionsInternal;\n  private _instance: IWasmDecoder;\n  private _wasm: IWasmDecoderExports;\n  private _states: Uint32Array;\n  private _chunk: Uint8Array;\n  private _palette: Uint32Array;\n  private _PIXEL_OFFSET = LIMITS.MAX_WIDTH + 4;\n  private _pSrc: Uint32Array;\n  private _canvas: Uint32Array = NULL_CANVAS;\n  private _bandWidths: number[] = [];\n  private _maxWidth = 0;\n  private _minWidth = LIMITS.MAX_WIDTH;\n  private _lastOffset = 0;\n  private _currentHeight = 0;\n\n  // some readonly parser states for internal usage\n  private get _fillColor(): RGBA8888 { return this._states[0]; }\n  private get _truncate(): number { return this._states[8]; }\n  private get _rasterWidth(): number { return this._states[6]; }\n  private get _rasterHeight(): number { return this._states[7]; }\n  private get _width(): number { return this._states[2] ? this._states[2] - 4 : 0; }\n  private get _height(): number { return this._states[3]; }\n  private get _level(): number { return this._states[9]; }\n  private get _mode(): ParseMode { return this._states[10]; }\n  private get _paletteLimit(): number { return this._states[11]; }\n\n  private _initCanvas(mode: ParseMode): number {\n    if (mode === ParseMode.M2) {\n      const pixels = this.width * this.height;\n      if (pixels > this._canvas.length) {\n        if (this._opts.memoryLimit && pixels * 4 > this._opts.memoryLimit) {\n          this.release();\n          throw new Error('image exceeds memory limit');\n        }\n        this._canvas = new Uint32Array(pixels);\n      }\n      this._maxWidth = this._width;\n    } else if (mode === ParseMode.M1) {\n      if (this._level === 2) {\n        // got raster attributes, use them as initial size hint\n        const pixels = Math.min(this._rasterWidth, LIMITS.MAX_WIDTH) * this._rasterHeight;\n        if (pixels > this._canvas.length) {\n          if (this._opts.memoryLimit && pixels * 4 > this._opts.memoryLimit) {\n            this.release();\n            throw new Error('image exceeds memory limit');\n          }\n          this._canvas = new Uint32Array(pixels);\n        }\n      } else {\n        // else fallback to generic resizing, starting with 256*256 pixels\n        if (this._canvas.length < 65536) {\n          this._canvas = new Uint32Array(65536);\n        }\n      }\n    }\n    return 0; // 0 - continue, 1 - abort right away\n  }\n\n  private _realloc(offset: number, additionalPixels: number): void {\n    const pixels = offset + additionalPixels;\n    if (pixels > this._canvas.length) {\n      if (this._opts.memoryLimit && pixels * 4 > this._opts.memoryLimit) {\n        this.release();\n        throw new Error('image exceeds memory limit');\n      }\n      // extend in 65536 pixel blocks\n      const newCanvas = new Uint32Array(Math.ceil(pixels / 65536) * 65536);\n      newCanvas.set(this._canvas);\n      this._canvas = newCanvas;\n    }\n  }\n\n  private _handle_band(width: number): number {\n    const adv = this._PIXEL_OFFSET;\n    let offset = this._lastOffset;\n    if (this._mode === ParseMode.M2) {\n      let remaining = this.height - this._currentHeight;\n      let c = 0;\n      while (c < 6 && remaining > 0) {\n        this._canvas.set(this._pSrc.subarray(adv * c, adv * c + width), offset + width * c);\n        c++;\n        remaining--;\n      }\n      this._lastOffset += width * c;\n      this._currentHeight += c;\n    } else if (this._mode === ParseMode.M1) {\n      this._realloc(offset, width * 6);\n      this._maxWidth = Math.max(this._maxWidth, width);\n      this._minWidth = Math.min(this._minWidth, width);\n      for (let i = 0; i < 6; ++i) {\n        this._canvas.set(this._pSrc.subarray(adv * i, adv * i + width), offset + width * i);\n      }\n      this._bandWidths.push(width);\n      this._lastOffset += width * 6;\n      this._currentHeight += 6;\n    }\n    return 0; // 0 - continue, 1 - abort right away\n  }\n\n  /**\n   * Synchonous ctor. Can be called from nodejs or a webworker context.\n   * For instantiation in the browser main thread use `WasmDecoderAsync` instead.\n   */\n  constructor(\n    opts?: IDecoderOptions,\n    _instance?: WebAssembly.Instance,\n    _cbProxy?: CallbackProxy\n  ) {\n    this._opts = Object.assign({}, DEFAULT_OPTIONS, opts);\n    if (this._opts.paletteLimit > LIMITS.PALETTE_SIZE) {\n      throw new Error(`DecoderOptions.paletteLimit must not exceed ${LIMITS.PALETTE_SIZE}`);\n    }\n    if (!_instance) {\n      const module = WASM_MODULE || (WASM_MODULE = new WebAssembly.Module(WASM_BYTES));\n      _instance = new WebAssembly.Instance(module, {\n        env: {\n          handle_band: this._handle_band.bind(this),\n          mode_parsed: this._initCanvas.bind(this)\n        }\n      });\n    } else {\n      _cbProxy!.bandHandler = this._handle_band.bind(this);\n      _cbProxy!.modeHandler = this._initCanvas.bind(this);\n    }\n    this._instance = _instance as IWasmDecoder;\n    this._wasm = this._instance.exports;\n    this._chunk = new Uint8Array(this._wasm.memory.buffer, this._wasm.get_chunk_address(), LIMITS.CHUNK_SIZE);\n    this._states = new Uint32Array(this._wasm.memory.buffer, this._wasm.get_state_address(), 12);\n    this._palette = new Uint32Array(this._wasm.memory.buffer, this._wasm.get_palette_address(), LIMITS.PALETTE_SIZE);\n    this._palette.set(this._opts.palette);\n    this._pSrc = new Uint32Array(this._wasm.memory.buffer, this._wasm.get_p0_address());\n    this._wasm.init(DEFAULT_FOREGROUND, 0, this._opts.paletteLimit, 0);\n  }\n\n  /**\n   * Width of the image data.\n   * Returns the rasterWidth in level2/truncating mode,\n   * otherwise the max width, that has been seen so far.\n   */\n  public get width(): number {\n    return this._mode !== ParseMode.M1\n      ? this._width\n      : Math.max(this._maxWidth, this._wasm.current_width());\n  }\n\n  /**\n   * Height of the image data.\n   * Returns the rasterHeight in level2/truncating mode,\n   * otherwise height touched by sixels.\n   */\n  public get height(): number {\n    return this._mode !== ParseMode.M1\n      ? this._height\n      : this._wasm.current_width()\n        ? this._bandWidths.length * 6 + this._wasm.current_height()\n        : this._bandWidths.length * 6;\n  }\n\n  /**\n   * Get active palette colors as RGBA8888[] (borrowed).\n   */\n  public get palette(): Uint32Array {\n    return this._palette.subarray(0, this._paletteLimit);\n  }\n\n  /**\n   * Get the memory used by the decoder.\n   *\n   * This is a rough estimate accounting the wasm instance memory\n   * and pixel buffers held on JS side (real value will be slightly\n   * higher due to JS book-keeping).\n   * Note that the decoder does not free ressources on its own,\n   * call `release` to free excess memory.\n   */\n  public get memoryUsage(): number {\n    return this._canvas.byteLength + this._wasm.memory.buffer.byteLength + 8 * this._bandWidths.length;\n  }\n\n  /**\n   * Get various properties of the decoder and the current image.\n   */\n  public get properties(): IDecoderProperties {\n    return {\n      width: this.width,\n      height: this.height,\n      mode: this._mode,\n      level: this._level,\n      truncate: !!this._truncate,\n      paletteLimit: this._paletteLimit,\n      fillColor: this._fillColor,\n      memUsage: this.memoryUsage,\n      rasterAttributes: {\n        numerator: this._states[4],\n        denominator: this._states[5],\n        width: this._rasterWidth,\n        height: this._rasterHeight,\n      }\n    };\n  }\n\n  /**\n   * Initialize decoder for next image. Must be called before\n   * any calls to `decode` or `decodeString`.\n   */\n  // FIXME: reorder arguments, better palette handling\n  public init(\n    fillColor: RGBA8888 = this._opts.fillColor,\n    palette: Uint32Array | null = this._opts.palette,\n    paletteLimit: number = this._opts.paletteLimit,\n    truncate: boolean = this._opts.truncate\n  ): void {\n    this._wasm.init(this._opts.sixelColor, fillColor, paletteLimit, truncate ? 1 : 0);\n    if (palette) {\n      this._palette.set(palette.subarray(0, LIMITS.PALETTE_SIZE));\n    }\n    this._bandWidths.length = 0;\n    this._maxWidth = 0;\n    this._minWidth = LIMITS.MAX_WIDTH;\n    this._lastOffset = 0;\n    this._currentHeight = 0;\n  }\n\n  /**\n   * Decode next chunk of data from start to end index (exclusive).\n   * @throws Will throw if the image exceeds the memory limit.\n   */\n  public decode(data: UintTypedArray, start: number = 0, end: number = data.length): void {\n    let p = start;\n    while (p < end) {\n      const length = Math.min(end - p, LIMITS.CHUNK_SIZE);\n      this._chunk.set(data.subarray(p, p += length));\n      this._wasm.decode(0, length);\n    }\n  }\n\n  /**\n   * Decode next chunk of string data from start to end index (exclusive).\n   * Note: Decoding from string data is rather slow, use `decode` with byte data instead.\n   * @throws Will throw if the image exceeds the memory limit.\n   */\n  public decodeString(data: string, start: number = 0, end: number = data.length): void {\n    let p = start;\n    while (p < end) {\n      const length = Math.min(end - p, LIMITS.CHUNK_SIZE);\n      for (let i = 0, j = p; i < length; ++i, ++j) {\n        this._chunk[i] = data.charCodeAt(j);\n      }\n      p += length;\n      this._wasm.decode(0, length);\n    }\n  }\n\n  /**\n   * Get current pixel data as 32-bit typed array (RGBA8888).\n   * Also peeks into pixel data of the current band, that got not pushed yet.\n   */\n  public get data32(): Uint32Array {\n    if (this._mode === ParseMode.M0 || !this.width || !this.height) {\n      return NULL_CANVAS;\n    }\n\n    // get width of pending band to peek into left-over data\n    const currentWidth = this._wasm.current_width();\n\n    if (this._mode === ParseMode.M2) {\n      let remaining = this.height - this._currentHeight;\n      if (remaining > 0) {\n        const adv = this._PIXEL_OFFSET;\n        let offset = this._lastOffset;\n        let c = 0;\n        while (c < 6 && remaining > 0) {\n          this._canvas.set(this._pSrc.subarray(adv * c, adv * c + currentWidth), offset + currentWidth * c);\n          c++;\n          remaining--;\n        }\n        if (remaining) {\n          this._canvas.fill(this._fillColor, offset + currentWidth * c);\n        }\n      }\n      return this._canvas.subarray(0, this.width * this.height);\n    }\n\n    if (this._mode === ParseMode.M1) {\n      if (this._minWidth === this._maxWidth) {\n        let escape = false;\n        if (currentWidth) {\n          if (currentWidth !== this._minWidth) {\n            escape = true;\n          } else {\n            const adv = this._PIXEL_OFFSET;\n            let offset = this._lastOffset;\n            this._realloc(offset, currentWidth * 6);\n            for (let i = 0; i < 6; ++i) {\n              this._canvas.set(this._pSrc.subarray(adv * i, adv * i + currentWidth), offset + currentWidth * i);\n            }\n          }\n        }\n        if (!escape) {\n          return this._canvas.subarray(0, this.width * this.height);\n        }\n      }\n\n      // worst case: re-align pixels if we have bands with different width\n      // This is somewhat allocation intensive, any way to do that in-place, and just once?\n      const final = new Uint32Array(this.width * this.height);\n      final.fill(this._fillColor);\n      let finalOffset = 0;\n      let start = 0;\n      for (let i = 0; i < this._bandWidths.length; ++i) {\n        const bw = this._bandWidths[i];\n        for (let p = 0; p < 6; ++p) {\n          final.set(this._canvas.subarray(start, start += bw), finalOffset);\n          finalOffset += this.width;\n        }\n      }\n      // also handle left-over pixels of the current band\n      if (currentWidth) {\n        const adv = this._PIXEL_OFFSET;\n        // other than finished bands, this runs only up to currentHeight\n        const currentHeight = this._wasm.current_height();\n        for (let i = 0; i < currentHeight; ++i) {\n          final.set(this._pSrc.subarray(adv * i, adv * i + currentWidth), finalOffset + this.width * i);\n        }\n      }\n      return final;\n    }\n\n    // fallthrough for all not handled cases\n    return NULL_CANVAS;\n  }\n\n  /**\n   * Same as `data32`, but returning pixel data as Uint8ClampedArray suitable\n   * for direct usage with `ImageData`.\n   */\n  public get data8(): Uint8ClampedArray {\n    return new Uint8ClampedArray(this.data32.buffer, 0, this.width * this.height * 4);\n  }\n\n  /**\n   * Release image ressources on JS side held by the decoder.\n   *\n   * The decoder tries to re-use memory ressources of a previous image\n   * to lower allocation and GC pressure. Decoding a single big image\n   * will grow the memory usage of the decoder permanently.\n   * Call `release` to reset the internal buffers and free the memory.\n   * Note that this destroys the image data, call it when done processing\n   * a rather big image, otherwise it is not needed. Use `memoryUsage`\n   * to decide, whether the held memory is still within your limits.\n   * This does not affect the wasm module (operates on static memory).\n   */\n  public release(): void {\n    this._canvas = NULL_CANVAS;\n    this._bandWidths.length = 0;\n    this._maxWidth = 0;\n    this._minWidth = LIMITS.MAX_WIDTH;\n    // also nullify parser states in wasm to avoid\n    // width/height reporting potential out-of-bound values\n    this._wasm.init(DEFAULT_FOREGROUND, 0, this._opts.paletteLimit, 0);\n  }\n}\n\n\n/**\n * Convenient decoding functions for easier usage.\n *\n * These can be used for casual decoding of sixel images,\n * that dont come in as stream chunks.\n * Note that the functions instantiate a stream decoder for every call,\n * which comes with a performance penalty of ~25%.\n */\n\n\n/**\n * Decode function with synchronous wasm loading.\n * Can be used in a web worker or in nodejs. Does not work reliable in normal browser context.\n * @throws Will throw if the image exceeds the memory limit.\n */\n export function decode(\n  data: UintTypedArray | string,\n  opts?: IDecoderOptions\n): IDecodeResult {\n  const dec = new Decoder(opts);\n  dec.init();\n  typeof data === 'string' ? dec.decodeString(data) : dec.decode(data);\n  return {\n    width: dec.width,\n    height: dec.height,\n    data32: dec.data32,\n    data8: dec.data8\n  };\n}\n\n/**\n * Decode function with asynchronous wasm loading.\n * Use this version in normal browser context.\n * @throws Will throw if the image exceeds the memory limit.\n */\nexport async function decodeAsync(\n  data: UintTypedArray | string,\n  opts?: IDecoderOptions\n): Promise<IDecodeResult> {\n  const dec = await DecoderAsync(opts);\n  dec.init();\n  typeof data === 'string' ? dec.decodeString(data) : dec.decode(data);\n  return {\n    width: dec.width,\n    height: dec.height,\n    data32: dec.data32,\n    data8: dec.data8\n  };\n}\n","interface IQuantizer {\n  getKDtree(data: Uint8Array | Uint8ClampedArray, colors: number): any;\n}\n\nexport const quantize: IQuantizer = require('../upng').quantize;\n","/**\n * Copyright (c) 2020 Joerg Breitbart.\n * @license MIT\n *\n * Parts taken from UPNG:\n * MIT License, Copyright (c) 2017 Photopea\n */\nimport { red, green, blue, fromRGBA8888 } from './Colors';\nimport { IQuantResult, RGBColor, RGBA8888 } from './Types';\nimport { quantize as UPNGQuantize } from './upng';\n\n\nfunction clamp8Bit(value: number): number {\n  return value >= 255 ? 255 : value < 0 ? 0 : value;\n}\n\n\nfunction applyError(value: number, r: number, g: number, b: number): number {\n  return ((0xFF00 | clamp8Bit(blue(value) + b))\n    << 8 | clamp8Bit(green(value) + g))\n    << 8 | clamp8Bit(red(value) + r);\n}\n\n\n/**\n * The internal quantizer currently relies on the kd tree quanization from UPNG.\n *\n * Planned:\n *  - SIXEL optimized quantizer without alpha channel and reduced RGB (only 1M colors possible)\n *  - better/customizable dithering algos\n *  - separate palette creation from image reduction\n *  - support for predefined palette (needs reconstruction of kd tree)\n *  - grayscale / monochrome transformations\n *\n * FIXME: Dithering should respect image dimensions.\n */\nexport function reduce(\n  data: Uint8Array | Uint8ClampedArray,\n  width: number,\n  colors: number): IQuantResult\n{\n  const data32 = new Uint32Array(data.buffer);\n\n  // palette creation with kd tree\n  const KD = UPNGQuantize.getKDtree(data.slice(), colors);\n  const leafs = KD[1];\n  const palette = leafs.map((el: any) => fromRGBA8888(el.est.rgba));\n  const cm = new ColorMatcher(palette);\n\n  const indices = new Uint16Array(data32.length);\n  const len = data32.length;\n  for (let i = 0; i < len; ++i) {\n    const v = data32[i];\n    const r = red(v);\n    const g = green(v);\n    const b = blue(v);\n\n    // boxed matching - compromise between exact match and performance\n    const idx = cm.nearest(v);\n    indices[i] = idx;\n\n    // dithering - FIXME: find better algo in terms of output quality and speed\n    const vp = leafs[idx].est.rgba;\n    let er = (r - red(vp)) >> 2;\n    let eg = (g - green(vp)) >> 2;\n    let eb = (b - blue(vp)) >> 2;\n\n    // FIXME: respect idx overflow / left and right border\n    data32[i + 1] = applyError(data32[i + 1], er, eg, eb);\n    data32[i + width] = applyError(data32[i + width], er, eg, eb);\n\n    er >>= 1;\n    eg >>= 1;\n    eb >>= 1;\n    data32[i + width - 1] = applyError(data32[i + width - 1], er, eg, eb);\n    data32[i + width + 1] = applyError(data32[i + width + 1], er, eg, eb);\n  }\n  return { indices, palette: leafs.map((el: any) => el.est.rgba) };\n}\n\n\n/**\n * Class to do nearest palette color matching with 16x16x16 boxes.\n */\nclass ColorMatcher {\n  private _boxes: { [key: number]: number[] } = {};\n  private _boxes2: { [key: number]: number[] } = {};\n\n  constructor(public palette: RGBColor[], radius: number = 14, radius2: number = 42) {\n    // limit: search sphere to add palette points from\n    // limit2: outer search sphere for uncertain area\n    // the value is chosen to get an error rate > 5%\n    // while not penalizing runtime too much (inner sphere is good trade off)\n    const limit = radius * radius * 3;\n    const limit2 = radius2 * radius2 * 3;\n    for (let i = 0; i < 4096; ++i) {\n      const x = i >> 8;\n      const y = i >> 4 & 15;\n      const z = i & 15;\n      this._nearestPoints(i, (x << 4) + 8, (y << 4) + 8, (z << 4) + 8, limit, limit2);\n    }\n  }\n\n  private _nearestPoints(box: number, r: number, g: number, b: number, limit: number, limit2: number): void {\n    let min = Number.MAX_SAFE_INTEGER;\n    let idx = -1;\n    const pointIndices: number[] = [];\n    const pointIndices2: number[] = [];\n    for (let i = 0; i < this.palette.length; ++i) {\n      const p_color = this.palette[i];\n      const d = this._distance(r, g, b, p_color[0], p_color[1], p_color[2]);\n      if (d < min) {\n        min = d;\n        idx = i;\n      }\n      if (d < limit) {\n        pointIndices.push(i);\n      } else if (d < limit2) {\n        pointIndices2.push(i);\n      }\n    }\n    if (pointIndices.length === 0) {\n      pointIndices.push(idx);\n    }\n    this._boxes[box] = pointIndices;\n    this._boxes2[box] = pointIndices2;\n  }\n\n  private _distance(r1: number, g1: number, b1: number, r2: number, g2: number, b2: number): number {\n    const dr = r1 - r2;\n    const dg = g1 - g2;\n    const db = b1 - b2;\n    return dr * dr + dg * dg + db * db;\n  }\n\n  public nearest(color: RGBA8888): number {\n    const r = red(color);\n    const g = green(color);\n    const b = blue(color);\n    const box = ((r >> 4) << 8) | ((g >> 4) << 4) | (b >> 4);\n    const indices = this._boxes[box];\n    let min = Number.MAX_SAFE_INTEGER;\n    let idx = -1;\n    // inner sphere handling\n    for (let i = 0; i < indices.length; ++i) {\n      const p_color = this.palette[indices[i]];\n      const d = this._distance(r, g, b, p_color[0], p_color[1], p_color[2]);\n      if (!d) return indices[i];\n      if (d < min) {\n        min = d;\n        idx = indices[i];\n      }\n    }\n    // check for outer sphere if point is within uncertain area (d > 8*8 + 8*8 + 8*8)\n    if (this._distance(r, g, b, (r & 0xF0) + 8, (g & 0xF0) + 8, (b & 0xF0) + 8) > 192) {\n      const indices = this._boxes2[box];\n      for (let i = 0; i < indices.length; ++i) {\n        const p_color = this.palette[indices[i]];\n        const d = this._distance(r, g, b, p_color[0], p_color[1], p_color[2]);\n        if (d < min) {\n          min = d;\n          idx = indices[i];\n        }\n      }\n    }\n    return idx;\n  }\n}\n","/**\n * Copyright (c) 2019 Joerg Breitbart.\n * @license MIT\n */\n\nimport { RGBA8888, RGBColor } from './Types';\nimport { toRGBA8888, fromRGBA8888, alpha, nearestColorIndex } from './Colors';\nimport { reduce } from './Quantizer';\n\n\n/**\n * Create escape sequence introducer for SIXEL.\n * Should be written to the terminal before any SIXEL data.\n *\n * A SIXEL DSC sequence understands 3 parameters, but only the second one (background select) is supported\n * by some terminals. Therefore only this parameter is exposed.\n *\n * backgroundSelect:\n *  - 0   device default action (most terminals will apply background color)\n *  - 1   no action (no change to zero bit value grid positions)\n *  - 2   set to background color - zero bit value grid positions are set to background color (device dependent).\n *\n * @see https://www.vt100.net/docs/vt3xx-gp/chapter14.html\n * @param backgroundSelect background color setting (default = 0)\n */\nexport function introducer(backgroundSelect: 0 | 1 | 2 = 0): string {\n  return `\\x1bP0;${backgroundSelect};q`;\n}\n\n\n/**\n * Finalize SIXEL sequence. Write this, when the SIXEL data stream has ended to restore\n * the terminal to normal operation.\n */\nexport const FINALIZER = '\\x1b\\\\';\n\n\n/**\n * Convert 6 bit code to SIXEL string.\n */\nfunction codeToSixel(code: number, repeat: number): string {\n  const c = String.fromCharCode(code + 63);\n  if (repeat > 3) return '!' + repeat + c;\n  if (repeat === 3) return c + c + c;\n  if (repeat === 2) return c + c;\n  return c;\n}\n\n\n/**\n * Create SIXEL data for a 6 pixel band.\n */\nfunction processBand(\n  data32: Uint32Array,\n  start: number,\n  bandHeight: number,\n  width: number,\n  colorMap: Map<RGBA8888, number>,\n  paletteRGB: RGBColor[]): string\n{\n  // temp buffers to hold various color data\n  // last: last seen SIXEL code per color\n  // code: current SIXEL code per color\n  // accu: count rows with equal SIXEL codes per color\n  // slots: palette color --> idx in usedColorIdx\n  const last = new Int8Array(paletteRGB.length + 1);\n  const code = new Uint8Array(paletteRGB.length + 1);\n  const accu = new Uint16Array(paletteRGB.length + 1);\n  const slots = new Int16Array(paletteRGB.length + 1);\n\n  last.fill(-1);\n  accu.fill(1);\n  slots.fill(-1);\n\n  // array to hold band local color idx\n  // only those are processed and written to output\n  // whenever a new color enters here we have to extend the accu/code handling below\n  const usedColorIdx: number[] = [];\n\n  // storage for SIXELs per color in band\n  const targets: string[][] = [];\n\n  let oldColor = 0;\n  let idx = 0;\n  for (let i = 0; i < width; ++i) {\n    const p = start + i;\n    let rowOffset = 0;\n    code.fill(0, 0, usedColorIdx.length);\n    for (let row = 0; row < bandHeight; ++row) {\n      const color = data32[p + rowOffset];\n      // skip expensive color to palette matching if we have same color as before\n      if (color !== oldColor) {\n        oldColor = color;\n        idx = alpha(color) ? colorMap.get(color) || 0 : 0;\n        if (idx === undefined) {\n          idx = nearestColorIndex(color, paletteRGB) + 1;\n          colorMap.set(color, idx);\n        }\n        // extend accu/code handling to new color\n        if (slots[idx] === -1) {\n          targets.push([]);\n          // if not at start catch up by writing 0s up to i for new color\n          // (happens during shift below)\n          if (i) {\n            last[usedColorIdx.length] = 0;\n            accu[usedColorIdx.length] = i;\n          }\n          slots[idx] = usedColorIdx.length;\n          usedColorIdx.push(idx);\n        }\n      }\n      // update codes for a row of 6 pixels\n      code[slots[idx]] |= 1 << row;\n      rowOffset += width;\n    }\n    // code/last/accu shift, updates SIXELs per color in band\n    for (let j = 0; j < usedColorIdx.length; ++j) {\n      if (code[j] === last[j]) {\n        accu[j]++;\n      } else {\n        if (~last[j]) {\n          targets[j].push(codeToSixel(last[j], accu[j]));\n        }\n        last[j] = code[j];\n        accu[j] = 1;\n      }\n    }\n\n  }\n  // handle remaining SIXELs to EOL\n  for (let j = 0; j < usedColorIdx.length; ++j) {\n    if (last[j]) {\n      targets[j].push(codeToSixel(last[j], accu[j]));\n    }\n  }\n  // write sixel chunk for every color in band\n  const result: string[] = [];\n  for (let j = 0; j < usedColorIdx.length; ++j) {\n    if (!usedColorIdx[j]) continue; // skip background\n    result.push('#' + (usedColorIdx[j] - 1) + targets[j].join('') + '$');\n  }\n  return result.join('');\n}\n\n\n/**\n * sixelEncode - encode pixel data to SIXEL string.\n *\n * The colors of the image get aligned to the given palette, unmatched colors will be translated\n * by euclidean distance. Without proper quantization beforehand this leads to poor output quality,\n * thus consider using a quantizer with custom palette creation and dithering.\n * For transparency only an alpha value of 0 will be respected as fully transparent,\n * other alpha values are set to fully opaque (255). Transparent pixels will be colored by the\n * terminal later on depending on the `backgroundSelect` setting of the introducer.\n *\n * To be in line with the SIXEL spec (DEC STD 070) `palette` should not contain more than 256 colors.\n * Note that older devices limit color registers even further (16 on VT340). Furthermore a high\n * number of colors will have a penalty on creation time, temporary memory usage and\n * the size of the SIXEL data. For simple graphics a rather small palette (16 to 64) might do,\n * for complicated pictures higher should work with 128+.\n *\n * @param data    pixel data\n * @param width   width of the image\n * @param height  height of the image\n * @param palette palette to be applied\n * @param rasterAttributes whether to write raster attributes (true)\n */\nexport function sixelEncode(\n  data: Uint8ClampedArray | Uint8Array,\n  width: number,\n  height: number,\n  palette: RGBA8888[] | RGBColor[],\n  rasterAttributes: boolean = true): string\n{\n  // some sanity checks\n  if (!data.length || !width || !height) {\n    return '';\n  }\n  if (width * height * 4 !== data.length) {\n    throw new Error('wrong geometry of data');\n  }\n  if (!palette || !palette.length) {\n    throw new Error('palette must not be empty');\n  }\n\n  // cleanup/prepare palettes\n  // paletteWithZero: holds background color in slot 0\n  // paletteRGB: list of [R, G, B] for ED calc\n  const paletteWithZero: RGBA8888[] = [0];\n  const paletteRGB: RGBColor[] = [];\n  for (let i = 0; i < palette.length; ++i) {\n    let color = palette[i];\n    if (typeof color === 'number') {\n      if (!alpha(color)) continue;\n      color = toRGBA8888(...fromRGBA8888(color));\n    } else {\n      color = toRGBA8888(...color);\n    }\n    if (!~paletteWithZero.indexOf(color)) {\n      paletteWithZero.push(color);\n      paletteRGB.push(fromRGBA8888(color).slice(0, -1) as RGBColor);\n    }\n  }\n\n  // SIXEL data storage\n  const chunks: string[] = [];\n\n  // write raster attributes (includes image dimensions) - \" Pan ; Pad ; Ph ; Pv\n  // note: Pan/Pad are set to dummies (not eval'd by any terminal)\n  if (rasterAttributes) {\n    chunks.push(`\"1;1;${width};${height}`);\n  }\n\n  // create palette and write color entries\n  for (let [idx, [r, g, b]] of paletteRGB.entries()) {\n    chunks.push(`#${idx};2;${Math.round(r / 255 * 100)};${Math.round(g / 255 * 100)};${Math.round(b / 255 * 100)}`);\n  }\n\n  // color --> slot\n  // if color does not match a palette color a suitable slot will be calculated from ED later on\n  const colorMap = new Map<RGBA8888, number>(paletteWithZero.map((el, idx) => [el, idx]));\n\n  // process in bands of 6 pixels\n  const bands: string[] = [];\n  const data32 = new Uint32Array(data.buffer);\n  for (let b = 0; b < height; b += 6) {\n    bands.push(processBand(data32, b * width, height - b >= 6 ? 6 : height - b, width, colorMap, paletteRGB));\n  }\n  chunks.push(bands.join('-\\n'));\n  return chunks.join('');\n}\n\n\n/**\n * Create SIXEL data for a 6 pixel band.\n * Same as `processBand`, but for correctly indexed colors.\n */\nfunction processBandIndexed(\n  indices: Uint16Array,\n  start: number,\n  bandHeight: number,\n  width: number,\n  last: Int8Array,\n  code: Uint8Array,\n  accu: Uint16Array,\n  slots: Int16Array): string\n{\n  // reset buffers\n  last.fill(-1);\n  code.fill(0);\n  accu.fill(1);\n  slots.fill(-1);\n\n  // array to hold band local color idx\n  // only those are processed and written to output\n  // whenever a new color enters here we have to extend the accu/code handling below\n  const usedColorIdx: number[] = [];\n\n  // storage for SIXELs per color in band\n  const targets: string[][] = [];\n\n  for (let i = 0; i < width; ++i) {\n    const p = start + i;\n    let rowOffset = 0;\n    code.fill(0, 0, usedColorIdx.length);\n    for (let row = 0; row < bandHeight; ++row) {\n      const idx = indices[p + rowOffset] + 1;   // FIXME: handle alpha = 0 case\n      if (slots[idx] === -1) {\n        targets.push([]);\n        // if not at start catch up by writing 0s up to i for new color\n        // (happens during shift below)\n        if (i) {\n          last[usedColorIdx.length] = 0;\n          accu[usedColorIdx.length] = i;\n        }\n        slots[idx] = usedColorIdx.length;\n        usedColorIdx.push(idx);\n      }\n      // update codes for a row of 6 pixels\n      code[slots[idx]] |= 1 << row;\n      rowOffset += width;\n    }\n    // code/last/accu shift, updates SIXELs per color in band\n    for (let j = 0; j < usedColorIdx.length; ++j) {\n      if (code[j] === last[j]) {\n        accu[j]++;\n      } else {\n        if (~last[j]) {\n          targets[j].push(codeToSixel(last[j], accu[j]));\n        }\n        last[j] = code[j];\n        accu[j] = 1;\n      }\n    }\n\n  }\n  // handle remaining SIXELs to EOL\n  for (let j = 0; j < usedColorIdx.length; ++j) {\n    if (last[j]) {\n      targets[j].push(codeToSixel(last[j], accu[j]));\n    }\n  }\n  // write sixel chunk for every color in band\n  const result: string[] = [];\n  for (let j = 0; j < usedColorIdx.length; ++j) {\n    if (!usedColorIdx[j]) continue; // skip background\n    result.push('#' + (usedColorIdx[j] - 1) + targets[j].join('') + '$');\n  }\n  return result.join('');\n}\n\n/**\n * sixelEncodeIndexed - encode indexed image data to SIXEL string.\n * Same as `sixelEncode`, but for correctly indexed colors.\n */\nexport function sixelEncodeIndexed(\n  indices: Uint16Array,\n  width: number,\n  height: number,\n  palette: RGBA8888[] | RGBColor[],\n  rasterAttributes: boolean = true): string\n{\n  // some sanity checks\n  if (!indices.length || !width || !height) {\n    return '';\n  }\n  if (width * height !== indices.length) {\n    throw new Error('wrong geometry of data');\n  }\n  if (!palette || !palette.length) {\n    throw new Error('palette must not be empty');\n  }\n\n  // cleanup/prepare palettes\n  // paletteWithZero: holds background color in slot 0\n  // paletteRGB: list of [R, G, B] for ED calc\n  const paletteWithZero: RGBA8888[] = [0];\n  const paletteRGB: RGBColor[] = [];\n  for (let i = 0; i < palette.length; ++i) {\n    let color = palette[i];\n    if (typeof color === 'number') {\n      if (!alpha(color)) continue;\n      color = toRGBA8888(...fromRGBA8888(color));\n    } else {\n      color = toRGBA8888(...color);\n    }\n    if (!~paletteWithZero.indexOf(color)) {\n      paletteWithZero.push(color);\n      paletteRGB.push(fromRGBA8888(color).slice(0, -1) as RGBColor);\n    }\n  }\n\n  // SIXEL data storage\n  const chunks: string[] = [];\n\n  // write raster attributes (includes image dimensions) - \" Pan ; Pad ; Ph ; Pv\n  // note: Pan/Pad are set to dummies (not eval'd by any terminal)\n  if (rasterAttributes) {\n    chunks.push(`\"1;1;${width};${height}`);\n  }\n\n  // create palette and write color entries\n  for (let [idx, [r, g, b]] of paletteRGB.entries()) {\n    chunks.push(`#${idx};2;${Math.round(r / 255 * 100)};${Math.round(g / 255 * 100)};${Math.round(b / 255 * 100)}`);\n  }\n\n  // temp buffers to hold various color data on band level\n  // last: last seen SIXEL code per color\n  // code: current SIXEL code per color\n  // accu: count rows with equal SIXEL codes per color\n  // slots: palette color --> idx in usedColorIdx\n  const last = new Int8Array(paletteRGB.length + 1);\n  const code = new Uint8Array(paletteRGB.length + 1);\n  const accu = new Uint16Array(paletteRGB.length + 1);\n  const slots = new Int16Array(paletteRGB.length + 1);\n\n  // process in bands of 6 pixels\n  const bands: string[] = [];\n  for (let b = 0; b < height; b += 6) {\n    bands.push(processBandIndexed(indices, b * width, height - b >= 6 ? 6 : height - b, width,\n      last, code, accu, slots));\n  }\n  chunks.push(bands.join('-\\n'));\n  return chunks.join('');\n}\n\n\n/**\n * Convenient function to create a full SIXEL escape sequence for given image data (alpha).\n *\n * Quantization is done by the internal quantizer, with dithering done on 4 neighboring pixels\n * for speed reasons, which works great for real pictures to level out hard color plane borders,\n * but might show moir or striping artefacts on color gradients.\n * Currently the dithering is not configurable, resort to custom quantizer\n * library in conjunction with `sixelEncode` if you observe dithering issues.\n *\n * @param data              pixel data\n * @param width             width of the image\n * @param height            height of the image\n * @param maxColors         max colors of the created palette\n * @param backgroundSelect  background select behavior for transparent pixels\n */\nexport function image2sixel(\n  data: Uint8Array | Uint8ClampedArray,\n  width: number,\n  height: number,\n  maxColors: number = 256,\n  backgroundSelect: 0 | 1 | 2 = 0): string\n{\n  // FIXME: sixelEncodeIndexed does not yet handle transparent pixels\n  // FIXME: dithering in reduce does not yet respect image width/height\n  const { indices, palette } = reduce(data, width, maxColors);\n  const sixelData = sixelEncodeIndexed(indices, width, height, palette);\n  return [introducer(backgroundSelect), sixelData, FINALIZER].join('');\n}\n"],"names":["N","W","H","module","exports","UPNG","toRGBA8","out","w","width","h","height","tabs","acTL","decodeImage","data","buffer","frms","frames","len","img","Uint8Array","empty","prev","i","length","frm","fx","rect","x","fy","y","fw","fh","fdata","j","blend","_copyTile","push","slice","dispose","area","bpp","decode","_getBPP","bpl","Math","ceil","bf","bf32","Uint32Array","ctype","depth","rs","_bin","readUshort","Date","now","qarea","ts","ti","tr","tg","tb","qi","p","ap","tl","s0","t0","cj","gr","di","off","to","al","buff","fd","offset","bin","rUs","rUi","readUint","dd","doff","foff","mgck","type","readASCII","_IHDR","num_frames","num_plays","fr","_decompress","rct","del","delay","round","nz","nextZero","keyw","text","bfr","_inflate","readUTF8","cflag","readBytes","pl","compress","interlace","filter","inflateRaw","_filterZero","_readInterlace","v","C","R","m","J","Q","X","u","d","V","n","b","A","e","l","M","I","Z","c","K","r","S","D","T","z","_","q","$","s","Y","a","set","byteOffset","Uint16Array","t","k","g","cbpp","starting_row","starting_col","row_increment","col_increment","pass","ri","ci","sw","sh","cr","cc","bpll","row","col","cdi","val","ii","paeth","_paeth","pa","pb","pc","writeUshort","writeUint","String","fromCharCode","writeASCII","charCodeAt","arr","pad","ns","toString","decodeURIComponent","sb","tw","th","xoff","yoff","mode","min","si","fa","fg","fb","ba","br","bg","bb","ifa","oa","ioa","encode","bufs","ps","dels","forbidPlte","nimg","compressPNG","_main","encodeLL","ac","bipp","bipl","crc","wUi","wUs","wAs","anim","pltAlpha","leng","dl","plte","cimg","wr","fi","imgd","ioff","levelZero","nh","prms","onlyBlend","evenCrd","forbidPrev","minBits","alphaAnd","ilen","gotAlpha","framize","cmap","inds","nbufs","abuf","concatRGBA","qres","quantize","console","log","cof","bln","est","rgba","img32","nw","ind","cmc","max","inj","alwaysBlend","cimg32","nx","ny","tlim","tstp","tarea","it","pimg","p32","mix","miy","may","sarea","_prepareDiff","r0","r1","miX","miY","_updateFrame","U8","U32","pimg32","cx","cy","rec","opts","fls","ftry","level","CMPR","UZIP","pako","_filterLine","tsize","table","tab","update","buf","o","nd","oimg","nimg32","KD","getKDtree","root","leafs","planeDst","getNearest","left","right","err","i0","i1","bst","tdst","stats","estats","maxL","mi","L","node","splitPixels","eMq255","ln","rn","sort","dist","node0","node1","eMq","d0","d1","d2","d3","vecDot","m0","m1","m2","m3","iN","Rj","M4","tmi","multVec","sqrt","dot","sml","abs","Cov","tlen","byteLength","noff","il","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","definition","key","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","red","green","blue","alpha","toRGBA8888","fromRGBA8888","color","nearestColorIndex","palette","Number","MAX_SAFE_INTEGER","idx","dr","dg","db","normalizeRGB","warn","PALETTE_VT340_COLOR","PALETTE_VT340_GREY","PALETTE_ANSI_256","DEFAULT_BACKGROUND","DEFAULT_FOREGROUND","LIMITS","WASM_BYTES","Buffer","from","bytestring","atob","result","decodeBase64","WASM_MODULE","NULL_CANVAS","CallbackProxy","bandHandler","modeHandler","handle_band","this","mode_parsed","DEFAULT_OPTIONS","memoryLimit","sixelColor","fillColor","paletteLimit","truncate","DecoderAsync","cbProxy","importObj","env","bind","WebAssembly","instantiate","then","inst","Decoder","instance","constructor","_instance","_cbProxy","_PIXEL_OFFSET","_canvas","_bandWidths","_maxWidth","_minWidth","_lastOffset","_currentHeight","_opts","assign","Error","_handle_band","_initCanvas","Module","Instance","_wasm","_chunk","memory","get_chunk_address","_states","get_state_address","_palette","get_palette_address","_pSrc","get_p0_address","init","_fillColor","_truncate","_rasterWidth","_rasterHeight","_width","_height","_level","_mode","_paletteLimit","pixels","release","_realloc","additionalPixels","newCanvas","adv","remaining","subarray","current_width","current_height","memoryUsage","properties","memUsage","rasterAttributes","numerator","denominator","start","end","decodeString","data32","currentWidth","fill","escape","final","finalOffset","bw","currentHeight","data8","Uint8ClampedArray","dec","async","decodeAsync","clamp8Bit","value","applyError","ColorMatcher","radius","radius2","_boxes","_boxes2","limit","limit2","_nearestPoints","box","pointIndices","pointIndices2","p_color","_distance","g1","b1","r2","g2","b2","nearest","indices","introducer","backgroundSelect","FINALIZER","codeToSixel","code","repeat","processBand","bandHeight","colorMap","paletteRGB","last","Int8Array","accu","slots","Int16Array","usedColorIdx","targets","oldColor","rowOffset","join","sixelEncode","paletteWithZero","indexOf","chunks","entries","Map","map","el","bands","processBandIndexed","image2sixel","maxColors","colors","cm","vp","er","eg","eb","reduce","sixelData","sixelEncodeIndexed"],"sourceRoot":""}